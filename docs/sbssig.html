<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 COSMIC Signature Identification | Sigminer: A Scalable Toolkit to Extract, Analyze and Visualize Mutational Signatures</title>
  <meta name="description" content="This package helps users to extract, analyze and visualize signatures from genomic variation records, thus providing new insight into cancer study." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 COSMIC Signature Identification | Sigminer: A Scalable Toolkit to Extract, Analyze and Visualize Mutational Signatures" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This package helps users to extract, analyze and visualize signatures from genomic variation records, thus providing new insight into cancer study." />
  <meta name="github-repo" content="ShixiangWang/sigminer-doc" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 COSMIC Signature Identification | Sigminer: A Scalable Toolkit to Extract, Analyze and Visualize Mutational Signatures" />
  
  <meta name="twitter:description" content="This package helps users to extract, analyze and visualize signatures from genomic variation records, thus providing new insight into cancer study." />
  

<meta name="author" content="Shixiang Wang, ShanghaiTech University" />
<meta name="author" content="Xue-Song Liu, ShanghaiTech University" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="cnsig.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">sigminer: Signature Miner</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#biological-significance-of-mutational-signature"><i class="fa fa-check"></i><b>1.1</b> Biological Significance of Mutational Signature</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sigminer"><i class="fa fa-check"></i><b>1.2</b> Sigminer</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.3</b> Installation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#issues-or-suggestions"><i class="fa fa-check"></i><b>1.4</b> Issues or Suggestions</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#preparation"><i class="fa fa-check"></i><b>1.5</b> Preparation</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#overview-of-contents"><i class="fa fa-check"></i><b>1.6</b> Overview of Contents</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#citation-and-license"><i class="fa fa-check"></i><b>1.7</b> Citation and LICENSE</a></li>
</ul></li>
<li class="part"><span><b>I Common Workflow</b></span></li>
<li class="chapter" data-level="2" data-path="sbssig.html"><a href="sbssig.html"><i class="fa fa-check"></i><b>2</b> COSMIC Signature Identification</a><ul>
<li class="chapter" data-level="2.1" data-path="sbssig.html"><a href="sbssig.html#read-data"><i class="fa fa-check"></i><b>2.1</b> Read Data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="sbssig.html"><a href="sbssig.html#vcf-as-input"><i class="fa fa-check"></i><b>2.1.1</b> VCF as input</a></li>
<li class="chapter" data-level="2.1.2" data-path="sbssig.html"><a href="sbssig.html#maf-as-input"><i class="fa fa-check"></i><b>2.1.2</b> MAF as input</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sbssig.html"><a href="sbssig.html#tally-components"><i class="fa fa-check"></i><b>2.2</b> Tally Components</a><ul>
<li class="chapter" data-level="2.2.1" data-path="sbssig.html"><a href="sbssig.html#the-most-common-96-components"><i class="fa fa-check"></i><b>2.2.1</b> The most common 96 components</a></li>
<li class="chapter" data-level="2.2.2" data-path="sbssig.html"><a href="sbssig.html#other-situations"><i class="fa fa-check"></i><b>2.2.2</b> Other Situations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sbssig.html"><a href="sbssig.html#extract-signatures"><i class="fa fa-check"></i><b>2.3</b> Extract Signatures</a><ul>
<li class="chapter" data-level="2.3.1" data-path="sbssig.html"><a href="sbssig.html#method-1-estimate-signature-number"><i class="fa fa-check"></i><b>2.3.1</b> Method 1: Estimate Signature Number</a></li>
<li class="chapter" data-level="2.3.2" data-path="sbssig.html"><a href="sbssig.html#method-1-extract-signatures"><i class="fa fa-check"></i><b>2.3.2</b> Method 1: Extract Signatures</a></li>
<li class="chapter" data-level="2.3.3" data-path="sbssig.html"><a href="sbssig.html#method-2-auto-extraction"><i class="fa fa-check"></i><b>2.3.3</b> Method 2: Auto-extraction</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sbssig.html"><a href="sbssig.html#match-signatures"><i class="fa fa-check"></i><b>2.4</b> Match Signatures</a></li>
<li class="chapter" data-level="2.5" data-path="sbssig.html"><a href="sbssig.html#operate-signature"><i class="fa fa-check"></i><b>2.5</b> Operate <code>Signature</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cnsig.html"><a href="cnsig.html"><i class="fa fa-check"></i><b>3</b> Copy Number Signature Identification</a><ul>
<li class="chapter" data-level="3.1" data-path="cnsig.html"><a href="cnsig.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="sbssig.html"><a href="sbssig.html#read-data"><i class="fa fa-check"></i><b>3.2</b> Read Data</a></li>
<li class="chapter" data-level="3.3" data-path="sbssig.html"><a href="sbssig.html#tally-components"><i class="fa fa-check"></i><b>3.3</b> Tally Components</a></li>
<li class="chapter" data-level="3.4" data-path="sbssig.html"><a href="sbssig.html#extract-signatures"><i class="fa fa-check"></i><b>3.4</b> Extract Signatures</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sigfit.html"><a href="sigfit.html"><i class="fa fa-check"></i><b>4</b> Signature Fit: Sample Signature Exposure Quantification and Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="sigfit.html"><a href="sigfit.html#fit-signatures-from-reference-databases"><i class="fa fa-check"></i><b>4.1</b> Fit Signatures from reference databases</a></li>
<li class="chapter" data-level="4.2" data-path="sigfit.html"><a href="sigfit.html#fit-custom-signatures"><i class="fa fa-check"></i><b>4.2</b> Fit Custom Signatures</a></li>
<li class="chapter" data-level="4.3" data-path="sigfit.html"><a href="sigfit.html#performance-comparison"><i class="fa fa-check"></i><b>4.3</b> Performance Comparison</a></li>
<li class="chapter" data-level="4.4" data-path="sigfit.html"><a href="sigfit.html#estimate-exposure-stability-by-bootstrap"><i class="fa fa-check"></i><b>4.4</b> Estimate Exposure Stability by Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="subtyping.html"><a href="subtyping.html"><i class="fa fa-check"></i><b>5</b> Subtype Prediction</a></li>
<li class="chapter" data-level="6" data-path="sigflow.html"><a href="sigflow.html"><i class="fa fa-check"></i><b>6</b> Sigflow Pipeline</a><ul>
<li class="chapter" data-level="6.1" data-path="sigflow.html"><a href="sigflow.html#cancer-type-specific-signature-index-database"><i class="fa fa-check"></i><b>6.1</b> Cancer type specific signature index database</a></li>
</ul></li>
<li class="part"><span><b>II Target Visualization</b></span></li>
<li class="chapter" data-level="7" data-path="cnobject.html"><a href="cnobject.html"><i class="fa fa-check"></i><b>7</b> CopyNumber Object</a><ul>
<li class="chapter" data-level="7.1" data-path="cnobject.html"><a href="cnobject.html#profile"><i class="fa fa-check"></i><b>7.1</b> Profile</a></li>
<li class="chapter" data-level="7.2" data-path="cnobject.html"><a href="cnobject.html#distribution"><i class="fa fa-check"></i><b>7.2</b> Distribution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sigobject.html"><a href="sigobject.html"><i class="fa fa-check"></i><b>8</b> Signature Object</a><ul>
<li class="chapter" data-level="8.1" data-path="sigobject.html"><a href="sigobject.html#signature-profile"><i class="fa fa-check"></i><b>8.1</b> Signature Profile</a><ul>
<li class="chapter" data-level="8.1.1" data-path="sigobject.html"><a href="sigobject.html#sbs-signature-profile"><i class="fa fa-check"></i><b>8.1.1</b> SBS Signature profile</a></li>
<li class="chapter" data-level="8.1.2" data-path="sigobject.html"><a href="sigobject.html#copy-number-signature-porfile"><i class="fa fa-check"></i><b>8.1.2</b> Copy Number Signature Porfile</a></li>
<li class="chapter" data-level="8.1.3" data-path="sigobject.html"><a href="sigobject.html#cosmic-signature-profile"><i class="fa fa-check"></i><b>8.1.3</b> COSMIC Signature Profile</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sigobject.html"><a href="sigobject.html#exposure-profile"><i class="fa fa-check"></i><b>8.2</b> Exposure Profile</a></li>
<li class="chapter" data-level="8.3" data-path="sigobject.html"><a href="sigobject.html#consensus-map"><i class="fa fa-check"></i><b>8.3</b> Consensus Map</a></li>
<li class="chapter" data-level="8.4" data-path="sigobject.html"><a href="sigobject.html#catalogue-profile"><i class="fa fa-check"></i><b>8.4</b> Catalogue Profile</a></li>
</ul></li>
<li class="part"><span><b>III Universal Analysis</b></span></li>
<li class="chapter" data-level="9" data-path="association-analysis.html"><a href="association-analysis.html"><i class="fa fa-check"></i><b>9</b> Association Analysis and Visualization</a></li>
<li class="chapter" data-level="10" data-path="group-analysis.html"><a href="group-analysis.html"><i class="fa fa-check"></i><b>10</b> Group Analysis and Visualization</a><ul>
<li class="chapter" data-level="10.1" data-path="group-analysis.html"><a href="group-analysis.html#group-generation"><i class="fa fa-check"></i><b>10.1</b> Group Generation</a></li>
<li class="chapter" data-level="10.2" data-path="group-analysis.html"><a href="group-analysis.html#group-comparison-analysis"><i class="fa fa-check"></i><b>10.2</b> Group Comparison Analysis</a></li>
<li class="chapter" data-level="10.3" data-path="group-analysis.html"><a href="group-analysis.html#group-visualization"><i class="fa fa-check"></i><b>10.3</b> Group Visualization</a></li>
</ul></li>
<li class="part"><span><b>IV Useful Utilities</b></span></li>
<li class="chapter" data-level="11" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>11</b> Datasets</a><ul>
<li class="chapter" data-level="11.1" data-path="datasets.html"><a href="datasets.html#reference-annotation"><i class="fa fa-check"></i><b>11.1</b> Reference Annotation</a></li>
<li class="chapter" data-level="11.2" data-path="datasets.html"><a href="datasets.html#copy-number-components-setting"><i class="fa fa-check"></i><b>11.2</b> Copy Number components setting</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="convert.html"><a href="convert.html"><i class="fa fa-check"></i><b>12</b> SBS Signature Conversion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sigminer: A Scalable Toolkit to Extract, Analyze and Visualize Mutational Signatures</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sbssig" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> COSMIC Signature Identification</h1>
<p>In this chapter, we will introduce how to identify COSMIC signatures from records of variant calling data.
The COSMIC signatures include three type of signatures: SBS, DBS and ID (short for INDEL).</p>
<p>The signature identification procedure has been divided into 3 steps:</p>
<ol style="list-style-type: decimal">
<li>Read mutation data.</li>
<li>Tally components: for SBS, it means classifying SBS records into 96 components (the most common case) and generate sample matrix.</li>
<li>Extract signatures: estimate signature number and identify signatures.</li>
</ol>
<div id="read-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Read Data</h2>
<blockquote>
<p>Make sure <code>library(sigminer)</code> before running the following code.</p>
</blockquote>
<p>The input data should be in <a href="https://www.ebi.ac.uk/training-beta/online/courses/human-genetic-variation-introduction/variant-identification-and-analysis/understanding-vcf-format/">VCF</a>, <a href="https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/">MAF</a> format.</p>
<ul>
<li>For VCF, it can only be VCF file paths.</li>
<li>For MAF, it can be either a MAF file or a <code>data.frame</code>.</li>
</ul>
<p>MAF format is the standard way to represent small-scale variants in Sigminer. There is a popular R/Bioconductor package <a href="https://github.com/PoisonAlien/maftools"><strong>maftools</strong></a> <span class="citation">(Mayakonda et al. <a href="#ref-mayakonda2018maftools" role="doc-biblioref">2018</a>)</span> for analyzing MAF data. It provides an R class <strong>MAF</strong> to represent MAF format data.</p>
<div id="vcf-as-input" class="section level3">
<h3><span class="header-section-number">2.1.1</span> VCF as input</h3>
<p>If you use VCF files as input, you can use <code>read_vcf()</code> to read multiple VCF files as a <code>MAF</code> object.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sbssig.html#cb6-1"></a>vcfs &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;sigminer&quot;</span>), <span class="st">&quot;*.vcf&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb6-2"><a href="sbssig.html#cb6-2"></a>maf &lt;-<span class="st"> </span><span class="kw">read_vcf</span>(vcfs)</span>
<span id="cb6-3"><a href="sbssig.html#cb6-3"></a><span class="co">#&gt; Reading file(s): /Users/wsx/Library/R/sigminer/extdata/test1.vcf, /Users/wsx/Library/R/sigminer/extdata/test2.vcf, /Users/wsx/Library/R/sigminer/extdata/test3.vcf</span></span>
<span id="cb6-4"><a href="sbssig.html#cb6-4"></a><span class="co">#&gt; Annotating Variant Type...</span></span>
<span id="cb6-5"><a href="sbssig.html#cb6-5"></a><span class="co">#&gt; Annotating mutations to first matched gene based on database /Users/wsx/Library/R/sigminer/extdata/human_hg19_gene_info.rds...</span></span>
<span id="cb6-6"><a href="sbssig.html#cb6-6"></a><span class="co">#&gt; Transforming into a MAF object...</span></span>
<span id="cb6-7"><a href="sbssig.html#cb6-7"></a><span class="co">#&gt; -Validating</span></span>
<span id="cb6-8"><a href="sbssig.html#cb6-8"></a><span class="co">#&gt; --Non MAF specific values in Variant_Classification column:</span></span>
<span id="cb6-9"><a href="sbssig.html#cb6-9"></a><span class="co">#&gt;   Unknown</span></span>
<span id="cb6-10"><a href="sbssig.html#cb6-10"></a><span class="co">#&gt; -Summarizing</span></span>
<span id="cb6-11"><a href="sbssig.html#cb6-11"></a><span class="co">#&gt; -Processing clinical data</span></span>
<span id="cb6-12"><a href="sbssig.html#cb6-12"></a><span class="co">#&gt; --Missing clinical data</span></span>
<span id="cb6-13"><a href="sbssig.html#cb6-13"></a><span class="co">#&gt; -Finished in 0.056s elapsed (0.036s cpu)</span></span>
<span id="cb6-14"><a href="sbssig.html#cb6-14"></a>maf &lt;-<span class="st"> </span><span class="kw">read_vcf</span>(vcfs, <span class="dt">keep_only_pass =</span> <span class="ot">FALSE</span>)</span>
<span id="cb6-15"><a href="sbssig.html#cb6-15"></a><span class="co">#&gt; Reading file(s): /Users/wsx/Library/R/sigminer/extdata/test1.vcf, /Users/wsx/Library/R/sigminer/extdata/test2.vcf, /Users/wsx/Library/R/sigminer/extdata/test3.vcf</span></span>
<span id="cb6-16"><a href="sbssig.html#cb6-16"></a><span class="co">#&gt; Annotating Variant Type...</span></span>
<span id="cb6-17"><a href="sbssig.html#cb6-17"></a><span class="co">#&gt; Annotating mutations to first matched gene based on database /Users/wsx/Library/R/sigminer/extdata/human_hg19_gene_info.rds...</span></span>
<span id="cb6-18"><a href="sbssig.html#cb6-18"></a><span class="co">#&gt; Transforming into a MAF object...</span></span>
<span id="cb6-19"><a href="sbssig.html#cb6-19"></a><span class="co">#&gt; -Validating</span></span>
<span id="cb6-20"><a href="sbssig.html#cb6-20"></a><span class="co">#&gt; --Non MAF specific values in Variant_Classification column:</span></span>
<span id="cb6-21"><a href="sbssig.html#cb6-21"></a><span class="co">#&gt;   Unknown</span></span>
<span id="cb6-22"><a href="sbssig.html#cb6-22"></a><span class="co">#&gt; -Summarizing</span></span>
<span id="cb6-23"><a href="sbssig.html#cb6-23"></a><span class="co">#&gt; -Processing clinical data</span></span>
<span id="cb6-24"><a href="sbssig.html#cb6-24"></a><span class="co">#&gt; --Missing clinical data</span></span>
<span id="cb6-25"><a href="sbssig.html#cb6-25"></a><span class="co">#&gt; -Finished in 0.035s elapsed (0.033s cpu)</span></span></code></pre></div>
</div>
<div id="maf-as-input" class="section level3">
<h3><span class="header-section-number">2.1.2</span> MAF as input</h3>
<p>MAF format is the most recommended input, you can provides it either as a file or as a <code>data.frame</code>.</p>
<p>Typically, you can obtain the data in the following ways:</p>
<ol style="list-style-type: decimal">
<li>You get multiple VCF files and convert them into a MAF file (<a href="https://github.com/mskcc/vcf2maf">vcf2maf</a> is the most used tool for conversion).</li>
<li>You get a MAF file from a reference or a public data portal, e.g., <a href="http://www.cbioportal.org/">cBioPortal</a> or <a href="https://portal.gdc.cancer.gov/">GDC portal</a>.</li>
<li>You get a EXCEL file providing MAF-like data from a reference, you should read the data firstly (with <code>readxl::read_excel()</code>) and then construct a <code>data.frame</code> providing necessary columns.</li>
</ol>
<p>Once a MAF file or a MAF-like <code>data.frame</code> is ready, you can read/convert it as a <code>MAF</code> object with <code>read_maf()</code>. Here TCGA LAML dataset is used as an example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sbssig.html#cb7-1"></a>laml.maf &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;tcga_laml.maf.gz&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;maftools&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-2"><a href="sbssig.html#cb7-2"></a>laml &lt;-<span class="st"> </span><span class="kw">read_maf</span>(<span class="dt">maf =</span> laml.maf)</span>
<span id="cb7-3"><a href="sbssig.html#cb7-3"></a><span class="co">#&gt; -Reading</span></span>
<span id="cb7-4"><a href="sbssig.html#cb7-4"></a><span class="co">#&gt; -Validating</span></span>
<span id="cb7-5"><a href="sbssig.html#cb7-5"></a><span class="co">#&gt; -Silent variants: 475 </span></span>
<span id="cb7-6"><a href="sbssig.html#cb7-6"></a><span class="co">#&gt; -Summarizing</span></span>
<span id="cb7-7"><a href="sbssig.html#cb7-7"></a><span class="co">#&gt; -Processing clinical data</span></span>
<span id="cb7-8"><a href="sbssig.html#cb7-8"></a><span class="co">#&gt; --Missing clinical data</span></span>
<span id="cb7-9"><a href="sbssig.html#cb7-9"></a><span class="co">#&gt; -Finished in 0.656s elapsed (0.346s cpu)</span></span>
<span id="cb7-10"><a href="sbssig.html#cb7-10"></a>laml</span>
<span id="cb7-11"><a href="sbssig.html#cb7-11"></a><span class="co">#&gt; An object of class  MAF </span></span>
<span id="cb7-12"><a href="sbssig.html#cb7-12"></a><span class="co">#&gt;                    ID          summary  Mean Median</span></span>
<span id="cb7-13"><a href="sbssig.html#cb7-13"></a><span class="co">#&gt;  1:        NCBI_Build               37    NA     NA</span></span>
<span id="cb7-14"><a href="sbssig.html#cb7-14"></a><span class="co">#&gt;  2:            Center genome.wustl.edu    NA     NA</span></span>
<span id="cb7-15"><a href="sbssig.html#cb7-15"></a><span class="co">#&gt;  3:           Samples              193    NA     NA</span></span>
<span id="cb7-16"><a href="sbssig.html#cb7-16"></a><span class="co">#&gt;  4:            nGenes             1241    NA     NA</span></span>
<span id="cb7-17"><a href="sbssig.html#cb7-17"></a><span class="co">#&gt;  5:   Frame_Shift_Del               52 0.269      0</span></span>
<span id="cb7-18"><a href="sbssig.html#cb7-18"></a><span class="co">#&gt;  6:   Frame_Shift_Ins               91 0.472      0</span></span>
<span id="cb7-19"><a href="sbssig.html#cb7-19"></a><span class="co">#&gt;  7:      In_Frame_Del               10 0.052      0</span></span>
<span id="cb7-20"><a href="sbssig.html#cb7-20"></a><span class="co">#&gt;  8:      In_Frame_Ins               42 0.218      0</span></span>
<span id="cb7-21"><a href="sbssig.html#cb7-21"></a><span class="co">#&gt;  9: Missense_Mutation             1342 6.953      7</span></span>
<span id="cb7-22"><a href="sbssig.html#cb7-22"></a><span class="co">#&gt; 10: Nonsense_Mutation              103 0.534      0</span></span>
<span id="cb7-23"><a href="sbssig.html#cb7-23"></a><span class="co">#&gt; 11:       Splice_Site               92 0.477      0</span></span>
<span id="cb7-24"><a href="sbssig.html#cb7-24"></a><span class="co">#&gt; 12:             total             1732 8.974      9</span></span></code></pre></div>
<p>The <code>laml</code> is a <code>MAF</code> object. The <code>MAF</code> class is exported from <strong>maftools</strong> to <strong>sigminer</strong>. So <code>laml</code> can be directly use functions provided by <strong>maftools</strong>.</p>
<p>As a <code>MAF</code> object, the mutation records are stored in slot <code>data</code> and <code>maf.silent</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="sbssig.html#cb8-1"></a><span class="kw">head</span>(laml<span class="op">@</span>data)</span>
<span id="cb8-2"><a href="sbssig.html#cb8-2"></a><span class="co">#&gt;    Hugo_Symbol Entrez_Gene_Id           Center NCBI_Build Chromosome Start_Position End_Position</span></span>
<span id="cb8-3"><a href="sbssig.html#cb8-3"></a><span class="co">#&gt; 1:      ABCA10          10349 genome.wustl.edu         37         17       67170917     67170917</span></span>
<span id="cb8-4"><a href="sbssig.html#cb8-4"></a><span class="co">#&gt; 2:       ABCA4             24 genome.wustl.edu         37          1       94490594     94490594</span></span>
<span id="cb8-5"><a href="sbssig.html#cb8-5"></a><span class="co">#&gt; 3:      ABCB11           8647 genome.wustl.edu         37          2      169780250    169780250</span></span>
<span id="cb8-6"><a href="sbssig.html#cb8-6"></a><span class="co">#&gt; 4:       ABCC3           8714 genome.wustl.edu         37         17       48760974     48760974</span></span>
<span id="cb8-7"><a href="sbssig.html#cb8-7"></a><span class="co">#&gt; 5:       ABCF1             23 genome.wustl.edu         37          6       30554429     30554429</span></span>
<span id="cb8-8"><a href="sbssig.html#cb8-8"></a><span class="co">#&gt; 6:       ABCG4          64137 genome.wustl.edu         37         11      119031351    119031351</span></span>
<span id="cb8-9"><a href="sbssig.html#cb8-9"></a><span class="co">#&gt;    Strand Variant_Classification Variant_Type Reference_Allele Tumor_Seq_Allele1</span></span>
<span id="cb8-10"><a href="sbssig.html#cb8-10"></a><span class="co">#&gt; 1:      +            Splice_Site          SNP                T                 T</span></span>
<span id="cb8-11"><a href="sbssig.html#cb8-11"></a><span class="co">#&gt; 2:      +      Missense_Mutation          SNP                C                 C</span></span>
<span id="cb8-12"><a href="sbssig.html#cb8-12"></a><span class="co">#&gt; 3:      +      Missense_Mutation          SNP                G                 G</span></span>
<span id="cb8-13"><a href="sbssig.html#cb8-13"></a><span class="co">#&gt; 4:      +      Missense_Mutation          SNP                C                 C</span></span>
<span id="cb8-14"><a href="sbssig.html#cb8-14"></a><span class="co">#&gt; 5:      +      Missense_Mutation          SNP                G                 G</span></span>
<span id="cb8-15"><a href="sbssig.html#cb8-15"></a><span class="co">#&gt; 6:      +      Missense_Mutation          SNP                A                 A</span></span>
<span id="cb8-16"><a href="sbssig.html#cb8-16"></a><span class="co">#&gt;    Tumor_Seq_Allele2 Tumor_Sample_Barcode Protein_Change i_TumorVAF_WU i_transcript_name</span></span>
<span id="cb8-17"><a href="sbssig.html#cb8-17"></a><span class="co">#&gt; 1:                 C         TCGA-AB-2988        p.K960R      45.66000       NM_080282.3</span></span>
<span id="cb8-18"><a href="sbssig.html#cb8-18"></a><span class="co">#&gt; 2:                 T         TCGA-AB-2869       p.R1517H      38.12000       NM_000350.2</span></span>
<span id="cb8-19"><a href="sbssig.html#cb8-19"></a><span class="co">#&gt; 3:                 A         TCGA-AB-3009       p.A1283V      46.97218       NM_003742.2</span></span>
<span id="cb8-20"><a href="sbssig.html#cb8-20"></a><span class="co">#&gt; 4:                 T         TCGA-AB-2887       p.P1271S      56.41000       NM_003786.1</span></span>
<span id="cb8-21"><a href="sbssig.html#cb8-21"></a><span class="co">#&gt; 5:                 A         TCGA-AB-2920        p.G658S      40.95000    NM_001025091.1</span></span>
<span id="cb8-22"><a href="sbssig.html#cb8-22"></a><span class="co">#&gt; 6:                 G         TCGA-AB-2934        p.Y567C      32.84000       NM_022169.1</span></span>
<span id="cb8-23"><a href="sbssig.html#cb8-23"></a><span class="kw">head</span>(laml<span class="op">@</span>maf.silent)</span>
<span id="cb8-24"><a href="sbssig.html#cb8-24"></a><span class="co">#&gt;    Hugo_Symbol Entrez_Gene_Id           Center NCBI_Build Chromosome Start_Position End_Position</span></span>
<span id="cb8-25"><a href="sbssig.html#cb8-25"></a><span class="co">#&gt; 1:      ABCC11          85320 genome.wustl.edu         37         16       48244997     48244997</span></span>
<span id="cb8-26"><a href="sbssig.html#cb8-26"></a><span class="co">#&gt; 2:        ACAN            176 genome.wustl.edu         37         15       89401084     89401084</span></span>
<span id="cb8-27"><a href="sbssig.html#cb8-27"></a><span class="co">#&gt; 3:       ACAT1             38 genome.wustl.edu         37         11      108009744    108009744</span></span>
<span id="cb8-28"><a href="sbssig.html#cb8-28"></a><span class="co">#&gt; 4:       ACCN2             41 genome.wustl.edu         37         12       50452780     50452780</span></span>
<span id="cb8-29"><a href="sbssig.html#cb8-29"></a><span class="co">#&gt; 5:       ACTA2             59 genome.wustl.edu         37         10       90695109     90695109</span></span>
<span id="cb8-30"><a href="sbssig.html#cb8-30"></a><span class="co">#&gt; 6:       ACTL9         284382 genome.wustl.edu         37         19        8808551      8808551</span></span>
<span id="cb8-31"><a href="sbssig.html#cb8-31"></a><span class="co">#&gt;    Strand Variant_Classification Variant_Type Reference_Allele Tumor_Seq_Allele1</span></span>
<span id="cb8-32"><a href="sbssig.html#cb8-32"></a><span class="co">#&gt; 1:      +                 Silent          SNP                G                 G</span></span>
<span id="cb8-33"><a href="sbssig.html#cb8-33"></a><span class="co">#&gt; 2:      +                 Silent          SNP                C                 C</span></span>
<span id="cb8-34"><a href="sbssig.html#cb8-34"></a><span class="co">#&gt; 3:      +                 Silent          SNP                T                 T</span></span>
<span id="cb8-35"><a href="sbssig.html#cb8-35"></a><span class="co">#&gt; 4:      +                 Silent          SNP                C                 C</span></span>
<span id="cb8-36"><a href="sbssig.html#cb8-36"></a><span class="co">#&gt; 5:      +                 Silent          SNP                C                 C</span></span>
<span id="cb8-37"><a href="sbssig.html#cb8-37"></a><span class="co">#&gt; 6:      +                 Silent          SNP                G                 G</span></span>
<span id="cb8-38"><a href="sbssig.html#cb8-38"></a><span class="co">#&gt;    Tumor_Seq_Allele2 Tumor_Sample_Barcode Protein_Change i_TumorVAF_WU i_transcript_name</span></span>
<span id="cb8-39"><a href="sbssig.html#cb8-39"></a><span class="co">#&gt; 1:                 A         TCGA-AB-2830        p.I490I    34.2700000       NM_032583.3</span></span>
<span id="cb8-40"><a href="sbssig.html#cb8-40"></a><span class="co">#&gt; 2:                 T         TCGA-AB-2898       p.S1756S    38.3000000       NM_013227.2</span></span>
<span id="cb8-41"><a href="sbssig.html#cb8-41"></a><span class="co">#&gt; 3:                 G         TCGA-AB-2887        p.T185T    49.0400000       NM_000019.3</span></span>
<span id="cb8-42"><a href="sbssig.html#cb8-42"></a><span class="co">#&gt; 4:                 G         TCGA-AB-3009         p.L77L    48.1000000       NM_020039.2</span></span>
<span id="cb8-43"><a href="sbssig.html#cb8-43"></a><span class="co">#&gt; 5:                 T         TCGA-AB-2973        p.P335P     0.2012072       NM_001613.1</span></span>
<span id="cb8-44"><a href="sbssig.html#cb8-44"></a><span class="co">#&gt; 6:                 A         TCGA-AB-2936        p.F167F    46.1500000       NM_178525.3</span></span></code></pre></div>
<p>The <code>data</code> slot contains non-silent variants, and the <code>maf.silent</code> slot contains silent variants.
Default uses Variant Classifications with High/Moderate variant consequences as non-silent variants. <a href="http://asia.ensembl.org/Help/Glossary?id=535" class="uri">http://asia.ensembl.org/Help/Glossary?id=535</a>: “Frame_Shift_Del”, “Frame_Shift_Ins”, “Splice_Site”, “Translation_Start_Site”,“Nonsense_Mutation”, “Nonstop_Mutation”, “In_Frame_Del”,“In_Frame_Ins”, “Missense_Mutation” (see <code>?read_maf</code>). If you want to change, please set <code>vc_nonSyn</code> option.</p>
<p>Other slots in <code>MAF</code> object are summary data either by sample or gene/variant type etc.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sbssig.html#cb9-1"></a><span class="kw">slotNames</span>(laml)</span>
<span id="cb9-2"><a href="sbssig.html#cb9-2"></a><span class="co">#&gt; [1] &quot;data&quot;                           &quot;variants.per.sample&quot;           </span></span>
<span id="cb9-3"><a href="sbssig.html#cb9-3"></a><span class="co">#&gt; [3] &quot;variant.type.summary&quot;           &quot;variant.classification.summary&quot;</span></span>
<span id="cb9-4"><a href="sbssig.html#cb9-4"></a><span class="co">#&gt; [5] &quot;gene.summary&quot;                   &quot;summary&quot;                       </span></span>
<span id="cb9-5"><a href="sbssig.html#cb9-5"></a><span class="co">#&gt; [7] &quot;maf.silent&quot;                     &quot;clinical.data&quot;</span></span></code></pre></div>
<p>Acute myeloid leukemia is not a good object to study mutational signatures due to low mutation burden, we will use a subset of TCGA breast cohort as for illustration of the following analyses.</p>
<p>Anand Mayakonda has already stored whole TCGA mutation data as MAF objects in <a href="https://github.com/PoisonAlien/TCGAmutations"><strong>TCGAmutations</strong></a> package.
Here I will load the TCGA BRCA cohort and create a sub-cohort with 100 tumors.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sbssig.html#cb10-1"></a><span class="kw">library</span>(TCGAmutations)</span>
<span id="cb10-2"><a href="sbssig.html#cb10-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">tcga_available</span>())</span></code></pre></div>
<table>
<colgroup>
<col width="15%" />
<col width="52%" />
<col width="4%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Study_Abbreviation</th>
<th align="left">Study_Name</th>
<th align="right">MC3</th>
<th align="left">Firehose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ACC</td>
<td align="left">Adrenocortical_carcinoma</td>
<td align="right">92</td>
<td align="left">62 [dx.doi.org/10.7908/C1610ZNC]</td>
</tr>
<tr class="even">
<td align="left">BLCA</td>
<td align="left">Bladder_Urothelial_Carcinoma</td>
<td align="right">411</td>
<td align="left">395 [dx.doi.org/10.7908/C1MW2GGF]</td>
</tr>
<tr class="odd">
<td align="left">BRCA</td>
<td align="left">Breast_invasive_carcinoma</td>
<td align="right">1020</td>
<td align="left">978 [dx.doi.org/10.7908/C1TB167Z]</td>
</tr>
<tr class="even">
<td align="left">CESC</td>
<td align="left">Cervical_squamous_cell_carcinoma_and_endocervical_adenocarcinoma</td>
<td align="right">289</td>
<td align="left">194 [dx.doi.org/10.7908/C1MG7NV6]</td>
</tr>
<tr class="odd">
<td align="left">CHOL</td>
<td align="left">Cholangiocarcinoma</td>
<td align="right">36</td>
<td align="left">35 [dx.doi.org/10.7908/C1K936V8]</td>
</tr>
<tr class="even">
<td align="left">COAD</td>
<td align="left">Colon_adenocarcinoma</td>
<td align="right">404</td>
<td align="left">367 [dx.doi.org/10.7908/C1DF6QJD]</td>
</tr>
<tr class="odd">
<td align="left">DLBC</td>
<td align="left">Lymphoid_Neoplasm_Diffuse_Large_B-cell_Lymphoma</td>
<td align="right">37</td>
<td align="left">48 [dx.doi.org/10.7908/C1X066DK]</td>
</tr>
<tr class="even">
<td align="left">ESCA</td>
<td align="left">Esophageal_carcinoma</td>
<td align="right">184</td>
<td align="left">185 [dx.doi.org/10.7908/C1BV7FZC]</td>
</tr>
<tr class="odd">
<td align="left">GBM</td>
<td align="left">Glioblastoma_multiforme</td>
<td align="right">390</td>
<td align="left">283 [dx.doi.org/10.7908/C1XG9QGN]</td>
</tr>
<tr class="even">
<td align="left">HNSC</td>
<td align="left">Head_and_Neck_squamous_cell_carcinoma</td>
<td align="right">507</td>
<td align="left">511 [dx.doi.org/10.7908/C18C9VM5]</td>
</tr>
<tr class="odd">
<td align="left">KICH</td>
<td align="left">Kidney_Chromophobe</td>
<td align="right">66</td>
<td align="left">66 [dx.doi.org/10.7908/C1765DQK]</td>
</tr>
<tr class="even">
<td align="left">KIRC</td>
<td align="left">Kidney_renal_clear_cell_carcinoma</td>
<td align="right">369</td>
<td align="left">476 [dx.doi.org/10.7908/C10864RM]</td>
</tr>
<tr class="odd">
<td align="left">KIRP</td>
<td align="left">Kidney_renal_papillary_cell_carcinoma</td>
<td align="right">281</td>
<td align="left">282 [dx.doi.org/10.7908/C19C6WTF]</td>
</tr>
<tr class="even">
<td align="left">LAML</td>
<td align="left">Acute_Myeloid_Leukemia</td>
<td align="right">140</td>
<td align="left">193 [dx.doi.org/10.7908/C1D21X2X]</td>
</tr>
<tr class="odd">
<td align="left">LGG</td>
<td align="left">Brain_Lower_Grade_Glioma</td>
<td align="right">511</td>
<td align="left">516 [dx.doi.org/10.7908/C1MC8ZDF]</td>
</tr>
<tr class="even">
<td align="left">LIHC</td>
<td align="left">Liver_hepatocellular_carcinoma</td>
<td align="right">363</td>
<td align="left">373 [dx.doi.org/10.7908/C128070B]</td>
</tr>
<tr class="odd">
<td align="left">LUAD</td>
<td align="left">Lung_adenocarcinoma</td>
<td align="right">515</td>
<td align="left">533 [dx.doi.org/10.7908/C17P8XT3]</td>
</tr>
<tr class="even">
<td align="left">LUSC</td>
<td align="left">Lung_squamous_cell_carcinoma</td>
<td align="right">485</td>
<td align="left">178 [dx.doi.org/10.7908/C1X34WXV]</td>
</tr>
<tr class="odd">
<td align="left">MESO</td>
<td align="left">Mesothelioma</td>
<td align="right">82</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">OV</td>
<td align="left">Ovarian_serous_cystadenocarcinoma</td>
<td align="right">411</td>
<td align="left">466 [dx.doi.org/10.7908/C1736QC5]</td>
</tr>
<tr class="odd">
<td align="left">PAAD</td>
<td align="left">Pancreatic_adenocarcinoma</td>
<td align="right">177</td>
<td align="left">126 [dx.doi.org/10.7908/C1513XNS]</td>
</tr>
<tr class="even">
<td align="left">PCPG</td>
<td align="left">Pheochromocytoma_and_Paraganglioma</td>
<td align="right">179</td>
<td align="left">179 [dx.doi.org/10.7908/C13T9GN0]</td>
</tr>
<tr class="odd">
<td align="left">PRAD</td>
<td align="left">Prostate_adenocarcinoma</td>
<td align="right">497</td>
<td align="left">498 [dx.doi.org/10.7908/C1Z037MV]</td>
</tr>
<tr class="even">
<td align="left">READ</td>
<td align="left">Rectum_adenocarcinoma</td>
<td align="right">149</td>
<td align="left">122 [dx.doi.org/10.7908/C1S46RDB]</td>
</tr>
<tr class="odd">
<td align="left">SARC</td>
<td align="left">Sarcoma</td>
<td align="right">236</td>
<td align="left">247 [dx.doi.org/10.7908/C137785M]</td>
</tr>
<tr class="even">
<td align="left">SKCM</td>
<td align="left">Skin_Cutaneous_Melanoma</td>
<td align="right">466</td>
<td align="left">290 [dx.doi.org/10.7908/C1J67GCG]</td>
</tr>
<tr class="odd">
<td align="left">STAD</td>
<td align="left">Stomach_adenocarcinoma</td>
<td align="right">439</td>
<td align="left">393 [dx.doi.org/10.7908/C1C828SM]</td>
</tr>
<tr class="even">
<td align="left">TGCT</td>
<td align="left">Testicular_Germ_Cell_Tumors</td>
<td align="right">129</td>
<td align="left">147 [dx.doi.org/10.7908/C1S1820D]</td>
</tr>
<tr class="odd">
<td align="left">THCA</td>
<td align="left">Thyroid_carcinoma</td>
<td align="right">492</td>
<td align="left">496 [dx.doi.org/10.7908/C16W99KN]</td>
</tr>
<tr class="even">
<td align="left">THYM</td>
<td align="left">Thymoma</td>
<td align="right">123</td>
<td align="left">120 [dx.doi.org/10.7908/C15T3JZ6]</td>
</tr>
<tr class="odd">
<td align="left">UCEC</td>
<td align="left">Uterine_Corpus_Endometrial_Carcinoma</td>
<td align="right">530</td>
<td align="left">248 [dx.doi.org/10.7908/C1C828T2]</td>
</tr>
<tr class="even">
<td align="left">UCS</td>
<td align="left">Uterine_Carcinosarcoma</td>
<td align="right">57</td>
<td align="left">57 [dx.doi.org/10.7908/C1PC31W8]</td>
</tr>
<tr class="odd">
<td align="left">UVM</td>
<td align="left">Uveal_Melanoma</td>
<td align="right">80</td>
<td align="left">80 [dx.doi.org/10.7908/C1S1821V]</td>
</tr>
<tr class="even">
<td align="left">Unknown</td>
<td align="left">Samples_I_couldnt_figure_out_the_source</td>
<td align="right">77</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="sbssig.html#cb11-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb11-2"><a href="sbssig.html#cb11-2"></a>brca &lt;-<span class="st"> </span><span class="kw">tcga_load</span>(<span class="st">&quot;BRCA&quot;</span>)</span>
<span id="cb11-3"><a href="sbssig.html#cb11-3"></a>brca &lt;-<span class="st"> </span>maftools<span class="op">::</span><span class="kw">subsetMaf</span>(brca,</span>
<span id="cb11-4"><a href="sbssig.html#cb11-4"></a>  <span class="dt">tsb =</span> <span class="kw">as.character</span>(<span class="kw">sample</span>(brca<span class="op">@</span>variants.per.sample<span class="op">$</span>Tumor_Sample_Barcode, <span class="dv">100</span>))</span>
<span id="cb11-5"><a href="sbssig.html#cb11-5"></a>)</span>
<span id="cb11-6"><a href="sbssig.html#cb11-6"></a><span class="kw">saveRDS</span>(brca, <span class="dt">file =</span> <span class="st">&quot;data/brca.rds&quot;</span>)</span></code></pre></div>
<blockquote>
<p>Here we save this cohort to let user can also run the examples without installing package TCGAmutations.</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="sbssig.html#cb12-1"></a>brca &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/brca.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="tally-components" class="section level2">
<h2><span class="header-section-number">2.2</span> Tally Components</h2>
<div id="the-most-common-96-components" class="section level3">
<h3><span class="header-section-number">2.2.1</span> The most common 96 components</h3>
<p>According to 3-nucleotide context (mutated base, 5’ and 3’ adjacent bases) and base complementary pairing principle, we can divide all SBS mutations into 96 mutation types. We call each mutation type as a <em>component</em> here.</p>
<blockquote>
<p>This classification is based the six substitution subtypes: C&gt;A, C&gt;G, C&gt;T, T&gt;A, T&gt;C, and T&gt;G (all substitutions are referred to by the pyrimidine of the mutated Watson—Crick base pair). Further, each of the substitutions is examined by incorporating information on the bases immediately 5’ and 3’ to each mutated base generating 96 possible mutation types (6 types of substitution x 4 types of 5’ base x 4 types of 3’ base).</p>
</blockquote>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-20"></span>
<img src="fig/MutationTypes_v3.jpg" alt="The illustration of 96 components, fig source: https://en.wikipedia.org/wiki/Mutational_signatures" width="400" />
<p class="caption">
Figure 2.1: The illustration of 96 components, fig source: <a href="https://en.wikipedia.org/wiki/Mutational_signatures" class="uri">https://en.wikipedia.org/wiki/Mutational_signatures</a>
</p>
</div>
<p>We tally components in each sample, and generate a sample-by-component matrix.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sbssig.html#cb13-1"></a>mt_tally &lt;-<span class="st"> </span><span class="kw">sig_tally</span>(</span>
<span id="cb13-2"><a href="sbssig.html#cb13-2"></a>  brca,</span>
<span id="cb13-3"><a href="sbssig.html#cb13-3"></a>  <span class="dt">ref_genome =</span> <span class="st">&quot;BSgenome.Hsapiens.UCSC.hg19&quot;</span>,</span>
<span id="cb13-4"><a href="sbssig.html#cb13-4"></a>  <span class="dt">useSyn =</span> <span class="ot">TRUE</span></span>
<span id="cb13-5"><a href="sbssig.html#cb13-5"></a>)</span>
<span id="cb13-6"><a href="sbssig.html#cb13-6"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:49]: Started.</span></span>
<span id="cb13-7"><a href="sbssig.html#cb13-7"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:49]: Reference genome loaded.</span></span>
<span id="cb13-8"><a href="sbssig.html#cb13-8"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:49]: Variants from MAF object queried.</span></span>
<span id="cb13-9"><a href="sbssig.html#cb13-9"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:50]: Chromosome names checked.</span></span>
<span id="cb13-10"><a href="sbssig.html#cb13-10"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:50]: Sex chromosomes properly handled.</span></span>
<span id="cb13-11"><a href="sbssig.html#cb13-11"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:50]: Only variants located in standard chromosomes (1:22, X, Y, M/MT) are kept.</span></span>
<span id="cb13-12"><a href="sbssig.html#cb13-12"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:50]: Variant start and end position checked.</span></span>
<span id="cb13-13"><a href="sbssig.html#cb13-13"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:50]: Variant data for matrix generation preprocessed.</span></span>
<span id="cb13-14"><a href="sbssig.html#cb13-14"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:50]: SBS matrix generation - start.</span></span>
<span id="cb13-15"><a href="sbssig.html#cb13-15"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:50]: Extracting 5&#39; and 3&#39; adjacent bases.</span></span>
<span id="cb13-16"><a href="sbssig.html#cb13-16"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:53]: Extracting +/- 20bp around mutated bases for background C&gt;T estimation.</span></span>
<span id="cb13-17"><a href="sbssig.html#cb13-17"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:53]: Estimating APOBEC enrichment scores.</span></span>
<span id="cb13-18"><a href="sbssig.html#cb13-18"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:53]: Performing one-way Fisher&#39;s test for APOBEC enrichment.</span></span>
<span id="cb13-19"><a href="sbssig.html#cb13-19"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: APOBEC related mutations are enriched in 28% of samples (APOBEC enrichment score &gt; 2; 28 of 100 samples)</span></span>
<span id="cb13-20"><a href="sbssig.html#cb13-20"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:53]: Creating SBS sample-by-component matrices.</span></span>
<span id="cb13-21"><a href="sbssig.html#cb13-21"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: SBS-6 matrix created.</span></span>
<span id="cb13-22"><a href="sbssig.html#cb13-22"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: SBS-96 matrix created.</span></span>
<span id="cb13-23"><a href="sbssig.html#cb13-23"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: SBS-1536 matrix created.</span></span>
<span id="cb13-24"><a href="sbssig.html#cb13-24"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:53]: Return SBS-96 as major matrix.</span></span>
<span id="cb13-25"><a href="sbssig.html#cb13-25"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: Done.</span></span>
<span id="cb13-26"><a href="sbssig.html#cb13-26"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:53]: 3.932 secs elapsed.</span></span></code></pre></div>
<blockquote>
<p>Here set <code>useSyn = TRUE</code> to include all variant records in MAF object to generate sample matrix.</p>
</blockquote>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sbssig.html#cb14-1"></a>mt_tally<span class="op">$</span>nmf_matrix[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb14-2"><a href="sbssig.html#cb14-2"></a><span class="co">#&gt;                              A[T&gt;C]A C[T&gt;C]A G[T&gt;C]A T[T&gt;C]A A[C&gt;T]A</span></span>
<span id="cb14-3"><a href="sbssig.html#cb14-3"></a><span class="co">#&gt; TCGA-A1-A0SH-01A-11D-A099-09       0       0       1       1       0</span></span>
<span id="cb14-4"><a href="sbssig.html#cb14-4"></a><span class="co">#&gt; TCGA-A2-A04N-01A-11D-A10Y-09       0       0       0       1       2</span></span>
<span id="cb14-5"><a href="sbssig.html#cb14-5"></a><span class="co">#&gt; TCGA-A2-A0CP-01A-11W-A050-09       0       0       0       0       0</span></span>
<span id="cb14-6"><a href="sbssig.html#cb14-6"></a><span class="co">#&gt; TCGA-A2-A0EP-01A-52D-A22X-09       0       0       1       0       0</span></span>
<span id="cb14-7"><a href="sbssig.html#cb14-7"></a><span class="co">#&gt; TCGA-A2-A0EV-01A-11W-A050-09       0       0       1       0       0</span></span></code></pre></div>
<p>We use notion <code>left[ref&gt;mut]right</code> to mark each component, e.g. <code>C[T&gt;G]A</code> means a base T with 5’ adjacent base C and 3’ adjacent base A is mutated to base G.</p>
</div>
<div id="other-situations" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Other Situations</h3>
<p>Above we show the most common SBS classifications, there are other situations supported by <strong>sigminer</strong>, including other classifications for SBS records and other mutation types (DBS and ID). All situations about SBS, DBS and ID signatures are well documented in <a href="https://osf.io/s93d5/wiki/home/">wiki of SigProfilerMatrixGenerator package</a>.</p>
<div id="other-sbs-classifications" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> Other SBS classifications</h4>
<p>After calling <code>sig_tally()</code>, the most used matrix is stored in <code>nmf_matrix</code>, and all matrices generated by <strong>sigminer</strong> are stored in <code>all_matrices</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="sbssig.html#cb15-1"></a><span class="kw">str</span>(mt_tally<span class="op">$</span>all_matrices, <span class="dt">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="sbssig.html#cb15-2"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb15-3"><a href="sbssig.html#cb15-3"></a><span class="co">#&gt;  $ SBS_6   : int [1:100, 1:6] 7 6 5 4 9 7 5 5 0 5 ...</span></span>
<span id="cb15-4"><a href="sbssig.html#cb15-4"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb15-5"><a href="sbssig.html#cb15-5"></a><span class="co">#&gt;  $ SBS_96  : int [1:100, 1:96] 0 0 0 0 0 0 1 2 0 0 ...</span></span>
<span id="cb15-6"><a href="sbssig.html#cb15-6"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb15-7"><a href="sbssig.html#cb15-7"></a><span class="co">#&gt;  $ SBS_1536: int [1:100, 1:1536] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb15-8"><a href="sbssig.html#cb15-8"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span></code></pre></div>
<p>If you add the strand classification, all matrices can be generated by <strong>sigminer</strong> will return.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sbssig.html#cb16-1"></a>mt_tally2 &lt;-<span class="st"> </span><span class="kw">sig_tally</span>(</span>
<span id="cb16-2"><a href="sbssig.html#cb16-2"></a>  brca,</span>
<span id="cb16-3"><a href="sbssig.html#cb16-3"></a>  <span class="dt">ref_genome =</span> <span class="st">&quot;BSgenome.Hsapiens.UCSC.hg19&quot;</span>,</span>
<span id="cb16-4"><a href="sbssig.html#cb16-4"></a>  <span class="dt">useSyn =</span> <span class="ot">TRUE</span>, <span class="dt">add_trans_bias =</span> <span class="ot">TRUE</span></span>
<span id="cb16-5"><a href="sbssig.html#cb16-5"></a>)</span>
<span id="cb16-6"><a href="sbssig.html#cb16-6"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:53]: Started.</span></span>
<span id="cb16-7"><a href="sbssig.html#cb16-7"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: Reference genome loaded.</span></span>
<span id="cb16-8"><a href="sbssig.html#cb16-8"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: Variants from MAF object queried.</span></span>
<span id="cb16-9"><a href="sbssig.html#cb16-9"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:53]: Chromosome names checked.</span></span>
<span id="cb16-10"><a href="sbssig.html#cb16-10"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:54]: Sex chromosomes properly handled.</span></span>
<span id="cb16-11"><a href="sbssig.html#cb16-11"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:54]: Only variants located in standard chromosomes (1:22, X, Y, M/MT) are kept.</span></span>
<span id="cb16-12"><a href="sbssig.html#cb16-12"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:54]: Variant start and end position checked.</span></span>
<span id="cb16-13"><a href="sbssig.html#cb16-13"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:54]: Variant data for matrix generation preprocessed.</span></span>
<span id="cb16-14"><a href="sbssig.html#cb16-14"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:54]: SBS matrix generation - start.</span></span>
<span id="cb16-15"><a href="sbssig.html#cb16-15"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:54]: Extracting 5&#39; and 3&#39; adjacent bases.</span></span>
<span id="cb16-16"><a href="sbssig.html#cb16-16"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:54]: Extracting +/- 20bp around mutated bases for background C&gt;T estimation.</span></span>
<span id="cb16-17"><a href="sbssig.html#cb16-17"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: Estimating APOBEC enrichment scores.</span></span>
<span id="cb16-18"><a href="sbssig.html#cb16-18"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: Performing one-way Fisher&#39;s test for APOBEC enrichment.</span></span>
<span id="cb16-19"><a href="sbssig.html#cb16-19"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: APOBEC related mutations are enriched in 28% of samples (APOBEC enrichment score &gt; 2; 28 of 100 samples)</span></span>
<span id="cb16-20"><a href="sbssig.html#cb16-20"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: Creating SBS sample-by-component matrices.</span></span>
<span id="cb16-21"><a href="sbssig.html#cb16-21"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: SBS-6 matrix created.</span></span>
<span id="cb16-22"><a href="sbssig.html#cb16-22"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: SBS-96 matrix created.</span></span>
<span id="cb16-23"><a href="sbssig.html#cb16-23"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: SBS-1536 matrix created.</span></span>
<span id="cb16-24"><a href="sbssig.html#cb16-24"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: SBS-24 (6x4) matrix created.</span></span>
<span id="cb16-25"><a href="sbssig.html#cb16-25"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: SBS-384 (96x4) matrix created.</span></span>
<span id="cb16-26"><a href="sbssig.html#cb16-26"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: SBS-6144 (1536x4) matrix created.</span></span>
<span id="cb16-27"><a href="sbssig.html#cb16-27"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: Return SBS-384 as major matrix.</span></span>
<span id="cb16-28"><a href="sbssig.html#cb16-28"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Done.</span></span>
<span id="cb16-29"><a href="sbssig.html#cb16-29"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: 1.755 secs elapsed.</span></span>
<span id="cb16-30"><a href="sbssig.html#cb16-30"></a></span>
<span id="cb16-31"><a href="sbssig.html#cb16-31"></a><span class="kw">str</span>(mt_tally2<span class="op">$</span>all_matrices, <span class="dt">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb16-32"><a href="sbssig.html#cb16-32"></a><span class="co">#&gt; List of 6</span></span>
<span id="cb16-33"><a href="sbssig.html#cb16-33"></a><span class="co">#&gt;  $ SBS_6   : int [1:100, 1:6] 7 6 5 4 9 7 5 5 0 5 ...</span></span>
<span id="cb16-34"><a href="sbssig.html#cb16-34"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb16-35"><a href="sbssig.html#cb16-35"></a><span class="co">#&gt;  $ SBS_24  : int [1:100, 1:24] 6 3 3 2 6 4 1 2 0 3 ...</span></span>
<span id="cb16-36"><a href="sbssig.html#cb16-36"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb16-37"><a href="sbssig.html#cb16-37"></a><span class="co">#&gt;  $ SBS_96  : int [1:100, 1:96] 0 0 0 0 0 0 1 2 0 0 ...</span></span>
<span id="cb16-38"><a href="sbssig.html#cb16-38"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb16-39"><a href="sbssig.html#cb16-39"></a><span class="co">#&gt;  $ SBS_384 : int [1:100, 1:384] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb16-40"><a href="sbssig.html#cb16-40"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb16-41"><a href="sbssig.html#cb16-41"></a><span class="co">#&gt;  $ SBS_1536: int [1:100, 1:1536] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb16-42"><a href="sbssig.html#cb16-42"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb16-43"><a href="sbssig.html#cb16-43"></a><span class="co">#&gt;  $ SBS_6144: int [1:100, 1:6144] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb16-44"><a href="sbssig.html#cb16-44"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span></code></pre></div>
</div>
<div id="dbs-and-id-components" class="section level4">
<h4><span class="header-section-number">2.2.2.2</span> DBS and ID components</h4>
<p>If you want to generate DBS or ID matrices, just modify the <code>mode</code> option.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="sbssig.html#cb17-1"></a>mt_tally_DBS &lt;-<span class="st"> </span><span class="kw">sig_tally</span>(</span>
<span id="cb17-2"><a href="sbssig.html#cb17-2"></a>  brca,</span>
<span id="cb17-3"><a href="sbssig.html#cb17-3"></a>  <span class="dt">ref_genome =</span> <span class="st">&quot;BSgenome.Hsapiens.UCSC.hg19&quot;</span>,</span>
<span id="cb17-4"><a href="sbssig.html#cb17-4"></a>  <span class="dt">useSyn =</span> <span class="ot">TRUE</span>,</span>
<span id="cb17-5"><a href="sbssig.html#cb17-5"></a>  <span class="dt">mode =</span> <span class="st">&quot;DBS&quot;</span>,</span>
<span id="cb17-6"><a href="sbssig.html#cb17-6"></a>  <span class="dt">add_trans_bias =</span> <span class="ot">TRUE</span></span>
<span id="cb17-7"><a href="sbssig.html#cb17-7"></a>)</span>
<span id="cb17-8"><a href="sbssig.html#cb17-8"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: Started.</span></span>
<span id="cb17-9"><a href="sbssig.html#cb17-9"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Reference genome loaded.</span></span>
<span id="cb17-10"><a href="sbssig.html#cb17-10"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Variants from MAF object queried.</span></span>
<span id="cb17-11"><a href="sbssig.html#cb17-11"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Chromosome names checked.</span></span>
<span id="cb17-12"><a href="sbssig.html#cb17-12"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Sex chromosomes properly handled.</span></span>
<span id="cb17-13"><a href="sbssig.html#cb17-13"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Only variants located in standard chromosomes (1:22, X, Y, M/MT) are kept.</span></span>
<span id="cb17-14"><a href="sbssig.html#cb17-14"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Variant start and end position checked.</span></span>
<span id="cb17-15"><a href="sbssig.html#cb17-15"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:55]: Variant data for matrix generation preprocessed.</span></span>
<span id="cb17-16"><a href="sbssig.html#cb17-16"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: DBS matrix generation - start.</span></span>
<span id="cb17-17"><a href="sbssig.html#cb17-17"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:55]: Searching DBS records...</span></span>
<span id="cb17-18"><a href="sbssig.html#cb17-18"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:56]: Done.</span></span>
<span id="cb17-19"><a href="sbssig.html#cb17-19"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Reference sequences queried from genome.</span></span>
<span id="cb17-20"><a href="sbssig.html#cb17-20"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: DBS-78 matrix created.</span></span>
<span id="cb17-21"><a href="sbssig.html#cb17-21"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: DBS-1248 matrix created.</span></span>
<span id="cb17-22"><a href="sbssig.html#cb17-22"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: DBS-186 matrix created.</span></span>
<span id="cb17-23"><a href="sbssig.html#cb17-23"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:57]: Return DBS-186 as major matrix.</span></span>
<span id="cb17-24"><a href="sbssig.html#cb17-24"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Done.</span></span>
<span id="cb17-25"><a href="sbssig.html#cb17-25"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:57]: 1.711 secs elapsed.</span></span>
<span id="cb17-26"><a href="sbssig.html#cb17-26"></a></span>
<span id="cb17-27"><a href="sbssig.html#cb17-27"></a><span class="kw">str</span>(mt_tally_DBS<span class="op">$</span>all_matrices, <span class="dt">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb17-28"><a href="sbssig.html#cb17-28"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb17-29"><a href="sbssig.html#cb17-29"></a><span class="co">#&gt;  $ DBS_78  : int [1:100, 1:78] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb17-30"><a href="sbssig.html#cb17-30"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb17-31"><a href="sbssig.html#cb17-31"></a><span class="co">#&gt;  $ DBS_186 : int [1:100, 1:186] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb17-32"><a href="sbssig.html#cb17-32"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb17-33"><a href="sbssig.html#cb17-33"></a><span class="co">#&gt;  $ DBS_1248: int [1:100, 1:1248] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb17-34"><a href="sbssig.html#cb17-34"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span></code></pre></div>
<blockquote>
<p>Program will stop if no records to analyze.</p>
</blockquote>
<p>Let’s see ID records.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="sbssig.html#cb18-1"></a>mt_tally_ID &lt;-<span class="st"> </span><span class="kw">sig_tally</span>(</span>
<span id="cb18-2"><a href="sbssig.html#cb18-2"></a>  brca,</span>
<span id="cb18-3"><a href="sbssig.html#cb18-3"></a>  <span class="dt">ref_genome =</span> <span class="st">&quot;BSgenome.Hsapiens.UCSC.hg19&quot;</span>,</span>
<span id="cb18-4"><a href="sbssig.html#cb18-4"></a>  <span class="dt">useSyn =</span> <span class="ot">TRUE</span>,</span>
<span id="cb18-5"><a href="sbssig.html#cb18-5"></a>  <span class="dt">mode =</span> <span class="st">&quot;ID&quot;</span>,</span>
<span id="cb18-6"><a href="sbssig.html#cb18-6"></a>  <span class="dt">add_trans_bias =</span> <span class="ot">TRUE</span></span>
<span id="cb18-7"><a href="sbssig.html#cb18-7"></a>)</span>
<span id="cb18-8"><a href="sbssig.html#cb18-8"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:57]: Started.</span></span>
<span id="cb18-9"><a href="sbssig.html#cb18-9"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Reference genome loaded.</span></span>
<span id="cb18-10"><a href="sbssig.html#cb18-10"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Variants from MAF object queried.</span></span>
<span id="cb18-11"><a href="sbssig.html#cb18-11"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Chromosome names checked.</span></span>
<span id="cb18-12"><a href="sbssig.html#cb18-12"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Sex chromosomes properly handled.</span></span>
<span id="cb18-13"><a href="sbssig.html#cb18-13"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Only variants located in standard chromosomes (1:22, X, Y, M/MT) are kept.</span></span>
<span id="cb18-14"><a href="sbssig.html#cb18-14"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Variant start and end position checked.</span></span>
<span id="cb18-15"><a href="sbssig.html#cb18-15"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:57]: Variant data for matrix generation preprocessed.</span></span>
<span id="cb18-16"><a href="sbssig.html#cb18-16"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:00:57]: INDEL matrix generation - start.</span></span>
<span id="cb18-17"><a href="sbssig.html#cb18-17"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:59]: Reference sequences queried from genome.</span></span>
<span id="cb18-18"><a href="sbssig.html#cb18-18"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:59]: INDEL length extracted.</span></span>
<span id="cb18-19"><a href="sbssig.html#cb18-19"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:00:59]: Adjacent copies counted.</span></span>
<span id="cb18-20"><a href="sbssig.html#cb18-20"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: Microhomology size calculated.</span></span>
<span id="cb18-21"><a href="sbssig.html#cb18-21"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: INDEL records classified into different components (types).</span></span>
<span id="cb18-22"><a href="sbssig.html#cb18-22"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: ID-28 matrix created.</span></span>
<span id="cb18-23"><a href="sbssig.html#cb18-23"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: ID-83 matrix created.</span></span>
<span id="cb18-24"><a href="sbssig.html#cb18-24"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: ID-415 matrix created.</span></span>
<span id="cb18-25"><a href="sbssig.html#cb18-25"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:28]: Return ID-415 as major matrix.</span></span>
<span id="cb18-26"><a href="sbssig.html#cb18-26"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: Done.</span></span>
<span id="cb18-27"><a href="sbssig.html#cb18-27"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:28]: 30.983 secs elapsed.</span></span>
<span id="cb18-28"><a href="sbssig.html#cb18-28"></a></span>
<span id="cb18-29"><a href="sbssig.html#cb18-29"></a><span class="kw">str</span>(mt_tally_ID<span class="op">$</span>all_matrices, <span class="dt">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb18-30"><a href="sbssig.html#cb18-30"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb18-31"><a href="sbssig.html#cb18-31"></a><span class="co">#&gt;  $ ID_28 : int [1:100, 1:28] 0 1 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb18-32"><a href="sbssig.html#cb18-32"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb18-33"><a href="sbssig.html#cb18-33"></a><span class="co">#&gt;  $ ID_83 : int [1:100, 1:83] 0 1 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb18-34"><a href="sbssig.html#cb18-34"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb18-35"><a href="sbssig.html#cb18-35"></a><span class="co">#&gt;  $ ID_415:&#39;data.frame&#39;:	100 obs. of  415 variables:</span></span></code></pre></div>
</div>
<div id="take-togother" class="section level4">
<h4><span class="header-section-number">2.2.2.3</span> Take togother</h4>
<p>If you want to get all matrices for SBS, DBS and ID at the same time, you don’t need to write a for loop or type three times to do this.
Just set <code>mode='ALL'</code>, <strong>sigminer</strong> will do it for you!</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="sbssig.html#cb19-1"></a>mt_tally_all &lt;-<span class="st"> </span><span class="kw">sig_tally</span>(</span>
<span id="cb19-2"><a href="sbssig.html#cb19-2"></a>  brca,</span>
<span id="cb19-3"><a href="sbssig.html#cb19-3"></a>  <span class="dt">ref_genome =</span> <span class="st">&quot;BSgenome.Hsapiens.UCSC.hg19&quot;</span>,</span>
<span id="cb19-4"><a href="sbssig.html#cb19-4"></a>  <span class="dt">useSyn =</span> <span class="ot">TRUE</span>,</span>
<span id="cb19-5"><a href="sbssig.html#cb19-5"></a>  <span class="dt">mode =</span> <span class="st">&quot;ALL&quot;</span>,</span>
<span id="cb19-6"><a href="sbssig.html#cb19-6"></a>  <span class="dt">add_trans_bias =</span> <span class="ot">TRUE</span></span>
<span id="cb19-7"><a href="sbssig.html#cb19-7"></a>)</span>
<span id="cb19-8"><a href="sbssig.html#cb19-8"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:28]: Started.</span></span>
<span id="cb19-9"><a href="sbssig.html#cb19-9"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: Reference genome loaded.</span></span>
<span id="cb19-10"><a href="sbssig.html#cb19-10"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:28]: Variants from MAF object queried.</span></span>
<span id="cb19-11"><a href="sbssig.html#cb19-11"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:29]: Chromosome names checked.</span></span>
<span id="cb19-12"><a href="sbssig.html#cb19-12"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:29]: Sex chromosomes properly handled.</span></span>
<span id="cb19-13"><a href="sbssig.html#cb19-13"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:29]: Only variants located in standard chromosomes (1:22, X, Y, M/MT) are kept.</span></span>
<span id="cb19-14"><a href="sbssig.html#cb19-14"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:29]: Variant start and end position checked.</span></span>
<span id="cb19-15"><a href="sbssig.html#cb19-15"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:29]: Variant data for matrix generation preprocessed.</span></span>
<span id="cb19-16"><a href="sbssig.html#cb19-16"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:29]: All types of matrices generation - start.</span></span>
<span id="cb19-17"><a href="sbssig.html#cb19-17"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:29]: SBS matrix generation - start.</span></span>
<span id="cb19-18"><a href="sbssig.html#cb19-18"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:29]: Extracting 5&#39; and 3&#39; adjacent bases.</span></span>
<span id="cb19-19"><a href="sbssig.html#cb19-19"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:31]: Extracting +/- 20bp around mutated bases for background C&gt;T estimation.</span></span>
<span id="cb19-20"><a href="sbssig.html#cb19-20"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:32]: Estimating APOBEC enrichment scores.</span></span>
<span id="cb19-21"><a href="sbssig.html#cb19-21"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:32]: Performing one-way Fisher&#39;s test for APOBEC enrichment.</span></span>
<span id="cb19-22"><a href="sbssig.html#cb19-22"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:32]: APOBEC related mutations are enriched in 28% of samples (APOBEC enrichment score &gt; 2; 28 of 100 samples)</span></span>
<span id="cb19-23"><a href="sbssig.html#cb19-23"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:32]: Creating SBS sample-by-component matrices.</span></span>
<span id="cb19-24"><a href="sbssig.html#cb19-24"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:32]: SBS-6 matrix created.</span></span>
<span id="cb19-25"><a href="sbssig.html#cb19-25"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:32]: SBS-96 matrix created.</span></span>
<span id="cb19-26"><a href="sbssig.html#cb19-26"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:32]: SBS-1536 matrix created.</span></span>
<span id="cb19-27"><a href="sbssig.html#cb19-27"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:33]: SBS-24 (6x4) matrix created.</span></span>
<span id="cb19-28"><a href="sbssig.html#cb19-28"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:33]: SBS-384 (96x4) matrix created.</span></span>
<span id="cb19-29"><a href="sbssig.html#cb19-29"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:33]: SBS-6144 (1536x4) matrix created.</span></span>
<span id="cb19-30"><a href="sbssig.html#cb19-30"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:33]: Return SBS-384 as major matrix.</span></span>
<span id="cb19-31"><a href="sbssig.html#cb19-31"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:33]: DBS matrix generation - start.</span></span>
<span id="cb19-32"><a href="sbssig.html#cb19-32"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:33]: Searching DBS records...</span></span>
<span id="cb19-33"><a href="sbssig.html#cb19-33"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:34]: Done.</span></span>
<span id="cb19-34"><a href="sbssig.html#cb19-34"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:35]: Reference sequences queried from genome.</span></span>
<span id="cb19-35"><a href="sbssig.html#cb19-35"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:35]: DBS-78 matrix created.</span></span>
<span id="cb19-36"><a href="sbssig.html#cb19-36"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:35]: DBS-1248 matrix created.</span></span>
<span id="cb19-37"><a href="sbssig.html#cb19-37"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:35]: DBS-186 matrix created.</span></span>
<span id="cb19-38"><a href="sbssig.html#cb19-38"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:35]: Return DBS-186 as major matrix.</span></span>
<span id="cb19-39"><a href="sbssig.html#cb19-39"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:01:35]: INDEL matrix generation - start.</span></span>
<span id="cb19-40"><a href="sbssig.html#cb19-40"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:37]: Reference sequences queried from genome.</span></span>
<span id="cb19-41"><a href="sbssig.html#cb19-41"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:37]: INDEL length extracted.</span></span>
<span id="cb19-42"><a href="sbssig.html#cb19-42"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:01:37]: Adjacent copies counted.</span></span>
<span id="cb19-43"><a href="sbssig.html#cb19-43"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:02:04]: Microhomology size calculated.</span></span>
<span id="cb19-44"><a href="sbssig.html#cb19-44"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:02:04]: INDEL records classified into different components (types).</span></span>
<span id="cb19-45"><a href="sbssig.html#cb19-45"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:02:04]: ID-28 matrix created.</span></span>
<span id="cb19-46"><a href="sbssig.html#cb19-46"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:02:04]: ID-83 matrix created.</span></span>
<span id="cb19-47"><a href="sbssig.html#cb19-47"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:02:04]: ID-415 matrix created.</span></span>
<span id="cb19-48"><a href="sbssig.html#cb19-48"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:02:04]: Return ID-415 as major matrix.</span></span>
<span id="cb19-49"><a href="sbssig.html#cb19-49"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:02:04]: All types of matrices generation (APOBEC scores included) - end.</span></span>
<span id="cb19-50"><a href="sbssig.html#cb19-50"></a><span class="co">#&gt; [32m✓[39m [2020-10-08 18:02:04]: Done.</span></span>
<span id="cb19-51"><a href="sbssig.html#cb19-51"></a><span class="co">#&gt; [36mℹ[39m [2020-10-08 18:02:04]: 35.948 secs elapsed.</span></span>
<span id="cb19-52"><a href="sbssig.html#cb19-52"></a></span>
<span id="cb19-53"><a href="sbssig.html#cb19-53"></a><span class="kw">str</span>(mt_tally_all, <span class="dt">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb19-54"><a href="sbssig.html#cb19-54"></a><span class="co">#&gt; List of 13</span></span>
<span id="cb19-55"><a href="sbssig.html#cb19-55"></a><span class="co">#&gt;  $ SBS_6        : int [1:100, 1:6] 7 6 5 4 9 7 5 5 0 5 ...</span></span>
<span id="cb19-56"><a href="sbssig.html#cb19-56"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-57"><a href="sbssig.html#cb19-57"></a><span class="co">#&gt;  $ SBS_24       : int [1:100, 1:24] 6 3 3 2 6 4 1 2 0 3 ...</span></span>
<span id="cb19-58"><a href="sbssig.html#cb19-58"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-59"><a href="sbssig.html#cb19-59"></a><span class="co">#&gt;  $ SBS_96       : int [1:100, 1:96] 0 0 0 0 0 0 1 2 0 0 ...</span></span>
<span id="cb19-60"><a href="sbssig.html#cb19-60"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-61"><a href="sbssig.html#cb19-61"></a><span class="co">#&gt;  $ SBS_384      : int [1:100, 1:384] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-62"><a href="sbssig.html#cb19-62"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-63"><a href="sbssig.html#cb19-63"></a><span class="co">#&gt;  $ SBS_1536     : int [1:100, 1:1536] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-64"><a href="sbssig.html#cb19-64"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-65"><a href="sbssig.html#cb19-65"></a><span class="co">#&gt;  $ SBS_6144     : int [1:100, 1:6144] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-66"><a href="sbssig.html#cb19-66"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-67"><a href="sbssig.html#cb19-67"></a><span class="co">#&gt;  $ DBS_78       : int [1:100, 1:78] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-68"><a href="sbssig.html#cb19-68"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-69"><a href="sbssig.html#cb19-69"></a><span class="co">#&gt;  $ DBS_186      : int [1:100, 1:186] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-70"><a href="sbssig.html#cb19-70"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-71"><a href="sbssig.html#cb19-71"></a><span class="co">#&gt;  $ DBS_1248     : int [1:100, 1:1248] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-72"><a href="sbssig.html#cb19-72"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-73"><a href="sbssig.html#cb19-73"></a><span class="co">#&gt;  $ ID_28        : int [1:100, 1:28] 0 1 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-74"><a href="sbssig.html#cb19-74"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-75"><a href="sbssig.html#cb19-75"></a><span class="co">#&gt;  $ ID_83        : int [1:100, 1:83] 0 1 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb19-76"><a href="sbssig.html#cb19-76"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb19-77"><a href="sbssig.html#cb19-77"></a><span class="co">#&gt;  $ ID_415       :&#39;data.frame&#39;:	100 obs. of  415 variables:</span></span>
<span id="cb19-78"><a href="sbssig.html#cb19-78"></a><span class="co">#&gt;  $ APOBEC_scores:Classes &#39;data.table&#39; and &#39;data.frame&#39;:	100 obs. of  44 variables:</span></span>
<span id="cb19-79"><a href="sbssig.html#cb19-79"></a><span class="co">#&gt;   ..- attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt; </span></span>
<span id="cb19-80"><a href="sbssig.html#cb19-80"></a><span class="co">#&gt;   ..- attr(*, &quot;index&quot;)= int(0) </span></span>
<span id="cb19-81"><a href="sbssig.html#cb19-81"></a><span class="co">#&gt;   .. ..- attr(*, &quot;__APOBEC_Enriched&quot;)= int [1:100] 17 21 23 24 25 26 27 28 30 32 ...</span></span></code></pre></div>
<p>Please note, in this case, just a list containing matrices will return.</p>
</div>
</div>
</div>
<div id="extract-signatures" class="section level2">
<h2><span class="header-section-number">2.3</span> Extract Signatures</h2>
<p>There are two different approaches can be used to implement signature extraction.</p>
<ol style="list-style-type: decimal">
<li>Semi-automatic way. Firstly estimate signature number and then extract signatures. This is the basic usage of <a href="https://github.com/renozao/NMF"><strong>NMF</strong></a> package <span class="citation">(Gaujoux and Seoighe <a href="#ref-gaujoux2010flexible" role="doc-biblioref">2010</a>)</span>. Run multiple times of NMF in a range of signature number firstly and compute some measures to let you consider which signature number is suitable and then extract specified number of signatures again with NMF package.</li>
<li>Automatic way. This includes multiple implementations, and will be described in corresponding part.</li>
</ol>
<div id="method-1-estimate-signature-number" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Method 1: Estimate Signature Number</h3>
<p>To estimate signature number, we firstly run NMF for multiple times and calculate some measures from the results, then select the best signature number based on the measure vs. signature number plot.</p>
<p>This is done by <code>sig_estimate()</code> function. Let’s try signature number 2-6. For simplicity, we just run NMF twice for each signature number. We use 4 cores to speed up the computation.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sbssig.html#cb20-1"></a><span class="kw">library</span>(NMF)</span>
<span id="cb20-2"><a href="sbssig.html#cb20-2"></a></span>
<span id="cb20-3"><a href="sbssig.html#cb20-3"></a>mt_est &lt;-<span class="st"> </span><span class="kw">sig_estimate</span>(mt_tally<span class="op">$</span>nmf_matrix,</span>
<span id="cb20-4"><a href="sbssig.html#cb20-4"></a>  <span class="dt">range =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">6</span>,</span>
<span id="cb20-5"><a href="sbssig.html#cb20-5"></a>  <span class="dt">nrun =</span> <span class="dv">10</span>, <span class="co"># increase this value if you wana a more stable estimation</span></span>
<span id="cb20-6"><a href="sbssig.html#cb20-6"></a>  <span class="dt">use_random =</span> <span class="ot">FALSE</span>, <span class="co"># if TRUE, add results from randomized input</span></span>
<span id="cb20-7"><a href="sbssig.html#cb20-7"></a>  <span class="dt">cores =</span> <span class="dv">4</span>,</span>
<span id="cb20-8"><a href="sbssig.html#cb20-8"></a>  <span class="dt">pConstant =</span> <span class="fl">1e-13</span>,</span>
<span id="cb20-9"><a href="sbssig.html#cb20-9"></a>  <span class="dt">verbose =</span> <span class="ot">TRUE</span></span>
<span id="cb20-10"><a href="sbssig.html#cb20-10"></a>)</span></code></pre></div>
<blockquote>
<p><code>pConstant</code> option is set to avoid errors raised by <strong>NMF</strong> package.</p>
</blockquote>
<p>We can show signature number survey for different measures by <code>show_sig_number_survey2()</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sbssig.html#cb21-1"></a><span class="co">## You can also select the measures to show</span></span>
<span id="cb21-2"><a href="sbssig.html#cb21-2"></a><span class="co">## by &#39;what&#39; option</span></span>
<span id="cb21-3"><a href="sbssig.html#cb21-3"></a><span class="kw">show_sig_number_survey2</span>(mt_est<span class="op">$</span>survey)</span></code></pre></div>
<p><img src="sigminer-doc_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" />
&gt; For the details of all the measures above, please read <span class="citation">Gaujoux and Seoighe (<a href="#ref-gaujoux2010flexible" role="doc-biblioref">2010</a>)</span> and <a href="https://cran.r-project.org/web/packages/NMF/vignettes/">vignette</a> of R package <strong>NMF</strong>.</p>
<p>The measures either provide stability (<code>cophenetic</code>) or how well can be reconstructed (<code>rss</code>).</p>
<p>Typically, measure <strong>cophenetic</strong> is used for determining the signature number. We can easily generate an elbow plot
with function <code>show_sig_number_survey()</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="sbssig.html#cb22-1"></a><span class="kw">show_sig_number_survey</span>(mt_est<span class="op">$</span>survey, <span class="dt">right_y =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="sigminer-doc_files/figure-html/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;" />
&gt; The most common approach is to use the cophenetic correlation coefficient. Brunet et al. suggested choosing the smallest value of r for which this coefficient starts decreasing. <span class="citation">(Gaujoux and Seoighe <a href="#ref-gaujoux2010flexible" role="doc-biblioref">2010</a>)</span></p>
<p>Cophenetic value (range from 0-1) indicates the robustness of consensus matrix clustering. In this situation, 3 is good. However, we can found that the cophenetic values are all &gt;=0.9 from 2 to 5. So the more suitable way is considering both stability and reconstruction error at the same time, it can be easily done by <code>show_sig_number_survey()</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="sbssig.html#cb23-1"></a><span class="kw">show_sig_number_survey</span>(mt_est<span class="op">$</span>survey)</span></code></pre></div>
<p><img src="sigminer-doc_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" />
&gt; This function is very flexible, you can pick up any measure to the left/right axis. However, the default setting is the most recommended way.</p>
<p>We can see that we get a minimal RSS in signature number, and when this value goes from 5 to 6, the RSS increase! So we should not choose signature number more than 5 here because 6 is overfitting.</p>
<p><strong>NOTE</strong>: There are no gold standard to determine the signature number. Sometimes, you should consider multiple measures. Remember, the most important thing is that <strong>you should have a good biological explanation for each signature</strong>.
The best solution in study may not be the best solution in math.</p>
</div>
<div id="method-1-extract-signatures" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Method 1: Extract Signatures</h3>
<p>After selecting a suitable signature number, now you can extract signatures. In general, use 30~50 NMF runs will get a robust result.</p>
<p>Here we extract 5 signatures.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="sbssig.html#cb24-1"></a>mt_sig &lt;-<span class="st"> </span><span class="kw">sig_extract</span>(mt_tally<span class="op">$</span>nmf_matrix,</span>
<span id="cb24-2"><a href="sbssig.html#cb24-2"></a>  <span class="dt">n_sig =</span> <span class="dv">5</span>,</span>
<span id="cb24-3"><a href="sbssig.html#cb24-3"></a>  <span class="dt">nrun =</span> <span class="dv">30</span>,</span>
<span id="cb24-4"><a href="sbssig.html#cb24-4"></a>  <span class="dt">cores =</span> <span class="dv">4</span>,</span>
<span id="cb24-5"><a href="sbssig.html#cb24-5"></a>  <span class="dt">pConstant =</span> <span class="fl">1e-13</span></span>
<span id="cb24-6"><a href="sbssig.html#cb24-6"></a>)</span></code></pre></div>
</div>
<div id="method-2-auto-extraction" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Method 2: Auto-extraction</h3>
<p>If you have no idea to select an optimal signature number from procedures above, you can try auto-extraction approaches provided by <strong>sigminer</strong>.</p>
<p>The latest version of <strong>sigminer</strong> provides two ways to auto-extract mutation signatures.</p>
<ol style="list-style-type: decimal">
<li>Auto-extract signatures by automatic relevance determination technique in non-negative matrix factorization <span class="citation">(Tan and Févotte <a href="#ref-tan2012automatic" role="doc-biblioref">2012</a>)</span>, the code is implemented by <strong>SignatureAnalyzer</strong> <span class="citation">(Kim et al. <a href="#ref-kim2016somatic" role="doc-biblioref">2016</a>)</span> and exported to <strong>sigminer</strong>. This approach is known as bayesian NMF.</li>
<li>Auto-extract signatures by <a href="https://github.com/AlexandrovLab/SigProfilerExtractor">SigProfiler</a>, the gold-standard tool used for identifying signatures cataloged in COSMIC database. The technical details please read <span class="citation">Alexandrov et al. (<a href="#ref-alexandrov2020repertoire" role="doc-biblioref">2020</a>)</span>.</li>
</ol>
<div id="method-2-bayesian-nmf" class="section level4">
<h4><span class="header-section-number">2.3.3.1</span> Method 2: bayesian NMF</h4>
<p>In this approach, you need to set a maximum signature number (default is <code>25</code>) and run times to get the result. 10 for <code>nrun</code> here is okay, and more than 100 is not recommended.
The bayesian NMF will starts from a larger signature number and reduce it to a proper signature number to maximize posterior probability.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="sbssig.html#cb25-1"></a>mt_sig2 &lt;-<span class="st"> </span><span class="kw">sig_auto_extract</span>(mt_tally<span class="op">$</span>nmf_matrix,</span>
<span id="cb25-2"><a href="sbssig.html#cb25-2"></a>  <span class="dt">K0 =</span> <span class="dv">10</span>, <span class="dt">nrun =</span> <span class="dv">10</span>,</span>
<span id="cb25-3"><a href="sbssig.html#cb25-3"></a>  <span class="dt">strategy =</span> <span class="st">&quot;stable&quot;</span></span>
<span id="cb25-4"><a href="sbssig.html#cb25-4"></a>)</span></code></pre></div>
<p>Here the program uses <strong>‘robust’ strategy</strong> to return the result (see <code>strategy</code> option). It means that if you run 10 times and 6 of them return <code>4</code> signatures, then the optimal result with <code>4</code> signatures will be returned.</p>
<p>The info of each run can be given as:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="sbssig.html#cb26-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mt_sig2<span class="op">$</span>Raw<span class="op">$</span>summary_run)</span></code></pre></div>
<table>
<colgroup>
<col width="4%" />
<col width="3%" />
<col width="10%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Run</th>
<th align="right">K</th>
<th align="right">posterior</th>
<th align="left">file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">-1497.670</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.3.rds</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">3</td>
<td align="right">-1497.752</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.9.rds</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">-1498.428</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.2.rds</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">3</td>
<td align="right">-1498.528</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.10.rds</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">3</td>
<td align="right">-1498.596</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.6.rds</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">-1498.830</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.1.rds</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">3</td>
<td align="right">-1498.890</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.7.rds</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">3</td>
<td align="right">-1499.207</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.4.rds</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">3</td>
<td align="right">-1524.316</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.8.rds</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">4</td>
<td align="right">-1617.962</td>
<td align="left">/var/folders/bj/nw1w4g1j37ddpgb6zmh3sfh80000gn/T//RtmpqXIwLJ/BayesNMF.5.rds</td>
</tr>
</tbody>
</table>
<p>The <code>mt_sig2</code> has similar structure as <code>mut_sig</code>.</p>
</div>
</div>
</div>
<div id="match-signatures" class="section level2">
<h2><span class="header-section-number">2.4</span> Match Signatures</h2>
<p>After extracting signatures, we need to know their etiologies. This can be done by comparing the identified signatures and reference signatures from COSMIC database.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="sbssig.html#cb27-1"></a>sim &lt;-<span class="st"> </span><span class="kw">get_sig_similarity</span>(mt_sig2)</span>
<span id="cb27-2"><a href="sbssig.html#cb27-2"></a><span class="co">#&gt; -Comparing against COSMIC signatures</span></span>
<span id="cb27-3"><a href="sbssig.html#cb27-3"></a><span class="co">#&gt; ------------------------------------</span></span>
<span id="cb27-4"><a href="sbssig.html#cb27-4"></a><span class="co">#&gt; --Found Sig1 most similar to COSMIC_3</span></span>
<span id="cb27-5"><a href="sbssig.html#cb27-5"></a><span class="co">#&gt;    Aetiology: defects in DNA-DSB repair by HR [similarity: 0.82]</span></span>
<span id="cb27-6"><a href="sbssig.html#cb27-6"></a><span class="co">#&gt; --Found Sig2 most similar to COSMIC_1</span></span>
<span id="cb27-7"><a href="sbssig.html#cb27-7"></a><span class="co">#&gt;    Aetiology: spontaneous deamination of 5-methylcytosine [similarity: 0.942]</span></span>
<span id="cb27-8"><a href="sbssig.html#cb27-8"></a><span class="co">#&gt; --Found Sig3 most similar to COSMIC_2</span></span>
<span id="cb27-9"><a href="sbssig.html#cb27-9"></a><span class="co">#&gt;    Aetiology: APOBEC Cytidine Deaminase (C&gt;T) [similarity: 0.84]</span></span>
<span id="cb27-10"><a href="sbssig.html#cb27-10"></a><span class="co">#&gt; ------------------------------------</span></span>
<span id="cb27-11"><a href="sbssig.html#cb27-11"></a><span class="co">#&gt; Return result invisiblely.</span></span></code></pre></div>
<p>The result object <code>sim</code> is a list.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="sbssig.html#cb28-1"></a><span class="kw">str</span>(sim)</span>
<span id="cb28-2"><a href="sbssig.html#cb28-2"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb28-3"><a href="sbssig.html#cb28-3"></a><span class="co">#&gt;  $ similarity  : num [1:3, 1:30] 0.82 0.264 0.373 0.581 0.942 0.165 0.085 0.256 0.84 0.714 ...</span></span>
<span id="cb28-4"><a href="sbssig.html#cb28-4"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb28-5"><a href="sbssig.html#cb28-5"></a><span class="co">#&gt;   .. ..$ : chr [1:3] &quot;Sig1&quot; &quot;Sig2&quot; &quot;Sig3&quot;</span></span>
<span id="cb28-6"><a href="sbssig.html#cb28-6"></a><span class="co">#&gt;   .. ..$ : chr [1:30] &quot;COSMIC_3&quot; &quot;COSMIC_1&quot; &quot;COSMIC_2&quot; &quot;COSMIC_4&quot; ...</span></span>
<span id="cb28-7"><a href="sbssig.html#cb28-7"></a><span class="co">#&gt;  $ aetiology_db:List of 1</span></span>
<span id="cb28-8"><a href="sbssig.html#cb28-8"></a><span class="co">#&gt;   ..$ : chr [1:30] &quot;spontaneous deamination of 5-methylcytosine&quot; &quot;APOBEC Cytidine Deaminase (C&gt;T)&quot; &quot;defects in DNA-DSB repair by HR&quot; &quot;exposure to tobacco (smoking) mutagens&quot; ...</span></span>
<span id="cb28-9"><a href="sbssig.html#cb28-9"></a><span class="co">#&gt;  $ best_match  :List of 3</span></span>
<span id="cb28-10"><a href="sbssig.html#cb28-10"></a><span class="co">#&gt;   ..$ Sig1:List of 2</span></span>
<span id="cb28-11"><a href="sbssig.html#cb28-11"></a><span class="co">#&gt;   .. ..$ aetiology : chr &quot;defects in DNA-DSB repair by HR&quot;</span></span>
<span id="cb28-12"><a href="sbssig.html#cb28-12"></a><span class="co">#&gt;   .. ..$ best_match: chr &quot;Best match: COSMIC_3 [similarity: 0.82]&quot;</span></span>
<span id="cb28-13"><a href="sbssig.html#cb28-13"></a><span class="co">#&gt;   ..$ Sig2:List of 2</span></span>
<span id="cb28-14"><a href="sbssig.html#cb28-14"></a><span class="co">#&gt;   .. ..$ aetiology : chr &quot;spontaneous deamination of 5-methylcytosine&quot;</span></span>
<span id="cb28-15"><a href="sbssig.html#cb28-15"></a><span class="co">#&gt;   .. ..$ best_match: chr &quot;Best match: COSMIC_1 [similarity: 0.942]&quot;</span></span>
<span id="cb28-16"><a href="sbssig.html#cb28-16"></a><span class="co">#&gt;   ..$ Sig3:List of 2</span></span>
<span id="cb28-17"><a href="sbssig.html#cb28-17"></a><span class="co">#&gt;   .. ..$ aetiology : chr &quot;APOBEC Cytidine Deaminase (C&gt;T)&quot;</span></span>
<span id="cb28-18"><a href="sbssig.html#cb28-18"></a><span class="co">#&gt;   .. ..$ best_match: chr &quot;Best match: COSMIC_2 [similarity: 0.84]&quot;</span></span>
<span id="cb28-19"><a href="sbssig.html#cb28-19"></a><span class="co">#&gt;  $ rss         : num [1:3, 1:30] 0.04166 0.00711 0.14698 0.2492 0.24257 ...</span></span>
<span id="cb28-20"><a href="sbssig.html#cb28-20"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb28-21"><a href="sbssig.html#cb28-21"></a><span class="co">#&gt;   .. ..$ : chr [1:3] &quot;Sig1&quot; &quot;Sig2&quot; &quot;Sig3&quot;</span></span>
<span id="cb28-22"><a href="sbssig.html#cb28-22"></a><span class="co">#&gt;   .. ..$ : chr [1:30] &quot;COSMIC_1&quot; &quot;COSMIC_2&quot; &quot;COSMIC_3&quot; &quot;COSMIC_4&quot; ...</span></span>
<span id="cb28-23"><a href="sbssig.html#cb28-23"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr [1:2] &quot;similarity&quot; &quot;list&quot;</span></span></code></pre></div>
<p>From the result we can see that three signatures are properly matched to COSMIC reference signatures. If you find unknown signatures in your study, you should explore the etiologies by other analyses and even experiments.</p>
<p>The similarity matrix can be plotted.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="sbssig.html#cb29-1"></a>pheatmap<span class="op">::</span><span class="kw">pheatmap</span>(sim<span class="op">$</span>similarity)</span></code></pre></div>
<p><img src="sigminer-doc_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can also try the COSMIC signature database V3 with:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sbssig.html#cb30-1"></a>sim_v3 &lt;-<span class="st"> </span><span class="kw">get_sig_similarity</span>(mt_sig2, <span class="dt">sig_db =</span> <span class="st">&quot;SBS&quot;</span>)</span>
<span id="cb30-2"><a href="sbssig.html#cb30-2"></a><span class="co">#&gt; -Comparing against COSMIC signatures</span></span>
<span id="cb30-3"><a href="sbssig.html#cb30-3"></a><span class="co">#&gt; ------------------------------------</span></span>
<span id="cb30-4"><a href="sbssig.html#cb30-4"></a><span class="co">#&gt; --Found Sig1 most similar to SBS3</span></span>
<span id="cb30-5"><a href="sbssig.html#cb30-5"></a><span class="co">#&gt;    Aetiology: Defects in DNA-DSB repair by HR [similarity: 0.821]</span></span>
<span id="cb30-6"><a href="sbssig.html#cb30-6"></a><span class="co">#&gt; --Found Sig2 most similar to SBS1</span></span>
<span id="cb30-7"><a href="sbssig.html#cb30-7"></a><span class="co">#&gt;    Aetiology: spontaneous or enzymatic deamination of 5-methylcytosine [similarity: 0.876]</span></span>
<span id="cb30-8"><a href="sbssig.html#cb30-8"></a><span class="co">#&gt; --Found Sig3 most similar to SBS2</span></span>
<span id="cb30-9"><a href="sbssig.html#cb30-9"></a><span class="co">#&gt;    Aetiology: APOBEC Cytidine Deaminase (C&gt;T) [similarity: 0.748]</span></span>
<span id="cb30-10"><a href="sbssig.html#cb30-10"></a><span class="co">#&gt; ------------------------------------</span></span>
<span id="cb30-11"><a href="sbssig.html#cb30-11"></a><span class="co">#&gt; Return result invisiblely.</span></span></code></pre></div>
</div>
<div id="operate-signature" class="section level2">
<h2><span class="header-section-number">2.5</span> Operate <code>Signature</code></h2>
<p>The result of <code>sig_extract()</code> or <code>sig_auto_extract()</code> is a <code>list</code> with <code>Signature</code> class. You can use <code>$</code> or use operation function to obtain the data stored in it.</p>
<p>To get the signature matrix:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sbssig.html#cb31-1"></a><span class="co"># Or mt_sig2$Signature</span></span>
<span id="cb31-2"><a href="sbssig.html#cb31-2"></a><span class="kw">sig_signature</span>(mt_sig2)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, ]</span>
<span id="cb31-3"><a href="sbssig.html#cb31-3"></a><span class="co">#&gt;                Sig1        Sig2         Sig3</span></span>
<span id="cb31-4"><a href="sbssig.html#cb31-4"></a><span class="co">#&gt; A[T&gt;C]A 0.008982565 0.012815512 0.0027641452</span></span>
<span id="cb31-5"><a href="sbssig.html#cb31-5"></a><span class="co">#&gt; C[T&gt;C]A 0.006295256 0.006378091 0.0008926155</span></span>
<span id="cb31-6"><a href="sbssig.html#cb31-6"></a><span class="co">#&gt; G[T&gt;C]A 0.013961272 0.002795088 0.0010525932</span></span>
<span id="cb31-7"><a href="sbssig.html#cb31-7"></a><span class="co">#&gt; T[T&gt;C]A 0.004574805 0.004748670 0.0012218410</span></span>
<span id="cb31-8"><a href="sbssig.html#cb31-8"></a><span class="co">#&gt; A[C&gt;T]A 0.004672896 0.018070168 0.0063343170</span></span></code></pre></div>
<p>To get signature exposure matrix:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="sbssig.html#cb32-1"></a><span class="co"># Or mt_sig$Exposure</span></span>
<span id="cb32-2"><a href="sbssig.html#cb32-2"></a><span class="kw">sig_exposure</span>(mt_sig2)[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb32-3"><a href="sbssig.html#cb32-3"></a><span class="co">#&gt;      TCGA-A1-A0SH-01A-11D-A099-09 TCGA-A2-A04N-01A-11D-A10Y-09 TCGA-A2-A0CP-01A-11W-A050-09</span></span>
<span id="cb32-4"><a href="sbssig.html#cb32-4"></a><span class="co">#&gt; Sig1                     32.15907                    15.839732                    22.947414</span></span>
<span id="cb32-5"><a href="sbssig.html#cb32-5"></a><span class="co">#&gt; Sig2                     16.59291                    32.478516                    22.476482</span></span>
<span id="cb32-6"><a href="sbssig.html#cb32-6"></a><span class="co">#&gt; Sig3                     87.05947                     3.137845                     4.608987</span></span>
<span id="cb32-7"><a href="sbssig.html#cb32-7"></a><span class="co">#&gt;      TCGA-A2-A0EP-01A-52D-A22X-09 TCGA-A2-A0EV-01A-11W-A050-09</span></span>
<span id="cb32-8"><a href="sbssig.html#cb32-8"></a><span class="co">#&gt; Sig1                   14.4657384                     35.25795</span></span>
<span id="cb32-9"><a href="sbssig.html#cb32-9"></a><span class="co">#&gt; Sig2                    0.4796753                     25.49099</span></span>
<span id="cb32-10"><a href="sbssig.html#cb32-10"></a><span class="co">#&gt; Sig3                    6.9200983                     17.57883</span></span></code></pre></div>
<p><code>get_sig_exposure()</code> may be more useful, it can be used to return a <code>data.frame</code> and set an exposure threshold.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sbssig.html#cb33-1"></a><span class="kw">get_sig_exposure</span>(mt_sig2)</span>
<span id="cb33-2"><a href="sbssig.html#cb33-2"></a><span class="co">#&gt;                            sample          Sig1          Sig2          Sig3</span></span>
<span id="cb33-3"><a href="sbssig.html#cb33-3"></a><span class="co">#&gt;   1: TCGA-A1-A0SH-01A-11D-A099-09  3.215907e+01  1.659291e+01  8.705947e+01</span></span>
<span id="cb33-4"><a href="sbssig.html#cb33-4"></a><span class="co">#&gt;   2: TCGA-A2-A04N-01A-11D-A10Y-09  1.583973e+01  3.247852e+01  3.137845e+00</span></span>
<span id="cb33-5"><a href="sbssig.html#cb33-5"></a><span class="co">#&gt;   3: TCGA-A2-A0CP-01A-11W-A050-09  2.294741e+01  2.247648e+01  4.608987e+00</span></span>
<span id="cb33-6"><a href="sbssig.html#cb33-6"></a><span class="co">#&gt;   4: TCGA-A2-A0EP-01A-52D-A22X-09  1.446574e+01  4.796753e-01  6.920098e+00</span></span>
<span id="cb33-7"><a href="sbssig.html#cb33-7"></a><span class="co">#&gt;   5: TCGA-A2-A0EV-01A-11W-A050-09  3.525795e+01  2.549099e+01  1.757883e+01</span></span>
<span id="cb33-8"><a href="sbssig.html#cb33-8"></a><span class="co">#&gt;   6: TCGA-A2-A0SX-01A-12D-A099-09  1.890198e+01  1.190887e+01  9.765504e+00</span></span>
<span id="cb33-9"><a href="sbssig.html#cb33-9"></a><span class="co">#&gt;   7: TCGA-A2-A0T7-01A-21D-A099-09  7.058436e+00  2.206062e+01  2.063678e-01</span></span>
<span id="cb33-10"><a href="sbssig.html#cb33-10"></a><span class="co">#&gt;   8: TCGA-A2-A0YF-01A-21D-A10G-09  1.308864e+01  2.872085e+01 3.276018e-121</span></span>
<span id="cb33-11"><a href="sbssig.html#cb33-11"></a><span class="co">#&gt;   9: TCGA-A2-A25F-01A-11D-A167-09  8.956460e+00 2.075076e-322  0.000000e+00</span></span>
<span id="cb33-12"><a href="sbssig.html#cb33-12"></a><span class="co">#&gt;  10: TCGA-A2-A3XW-01A-11D-A23C-09  1.022872e+01  7.998442e+00  6.307634e-01</span></span>
<span id="cb33-13"><a href="sbssig.html#cb33-13"></a><span class="co">#&gt;  11: TCGA-A2-A4S1-01A-21D-A25Q-09  7.051307e+01  2.151502e+01  4.647996e+00</span></span>
<span id="cb33-14"><a href="sbssig.html#cb33-14"></a><span class="co">#&gt;  12: TCGA-A7-A0D9-01A-31W-A071-09  2.911793e+01  1.460116e+01  1.642104e+01</span></span>
<span id="cb33-15"><a href="sbssig.html#cb33-15"></a><span class="co">#&gt;  13: TCGA-A7-A13F-01A-11D-A12Q-09  1.445889e-99  7.200445e+01  1.005387e+01</span></span>
<span id="cb33-16"><a href="sbssig.html#cb33-16"></a><span class="co">#&gt;  14: TCGA-A7-A5ZV-01A-11D-A28B-09  1.744084e+02  3.859699e+01  3.691587e+01</span></span>
<span id="cb33-17"><a href="sbssig.html#cb33-17"></a><span class="co">#&gt;  15: TCGA-A8-A06P-01A-11W-A019-09  2.224565e+01  1.850442e+01  3.520406e+00</span></span>
<span id="cb33-18"><a href="sbssig.html#cb33-18"></a><span class="co">#&gt;  16: TCGA-A8-A076-01A-21W-A019-09  3.334543e+01  4.665212e+01  1.243664e+01</span></span>
<span id="cb33-19"><a href="sbssig.html#cb33-19"></a><span class="co">#&gt;  17: TCGA-A8-A07W-01A-11W-A019-09  1.027996e+02  4.510342e+01  2.145630e+01</span></span>
<span id="cb33-20"><a href="sbssig.html#cb33-20"></a><span class="co">#&gt;  18: TCGA-A8-A084-01A-21W-A019-09  1.875160e+01  3.524792e+01  2.879974e+01</span></span>
<span id="cb33-21"><a href="sbssig.html#cb33-21"></a><span class="co">#&gt;  19: TCGA-A8-A08S-01A-11W-A050-09  1.735008e+01  4.659754e+01  1.427450e-05</span></span>
<span id="cb33-22"><a href="sbssig.html#cb33-22"></a><span class="co">#&gt;  20: TCGA-A8-A09G-01A-21W-A019-09  2.720241e-49  1.598340e+01  3.015537e+02</span></span>
<span id="cb33-23"><a href="sbssig.html#cb33-23"></a><span class="co">#&gt;  21: TCGA-A8-A0A4-01A-11W-A019-09  1.301530e+01  2.414905e+01  9.673844e-01</span></span>
<span id="cb33-24"><a href="sbssig.html#cb33-24"></a><span class="co">#&gt;  22: TCGA-A8-A0AB-01A-11W-A050-09  2.224326e+01  1.070162e+01  4.625000e+00</span></span>
<span id="cb33-25"><a href="sbssig.html#cb33-25"></a><span class="co">#&gt;  23: TCGA-AC-A2B8-01A-11D-A17D-09  4.581254e-74  2.077930e+01  1.039934e+02</span></span>
<span id="cb33-26"><a href="sbssig.html#cb33-26"></a><span class="co">#&gt;  24: TCGA-AC-A2FO-01A-11D-A17W-09  8.224234e+00  6.022061e+00  1.457732e+01</span></span>
<span id="cb33-27"><a href="sbssig.html#cb33-27"></a><span class="co">#&gt;  25: TCGA-AC-A3YI-01A-21D-A23C-09  1.181688e+01  8.021717e+00 4.392543e-188</span></span>
<span id="cb33-28"><a href="sbssig.html#cb33-28"></a><span class="co">#&gt;  26: TCGA-AC-A8OS-01A-12D-A41F-09  3.481344e+01  2.558226e+01  1.892168e+01</span></span>
<span id="cb33-29"><a href="sbssig.html#cb33-29"></a><span class="co">#&gt;  27: TCGA-AN-A0FK-01A-11W-A050-09  2.057755e-97  5.410512e+01 6.931546e-201</span></span>
<span id="cb33-30"><a href="sbssig.html#cb33-30"></a><span class="co">#&gt;  28: TCGA-AN-A0FT-01A-11W-A050-09  2.445782e+01  6.250409e+01  3.692872e+01</span></span>
<span id="cb33-31"><a href="sbssig.html#cb33-31"></a><span class="co">#&gt;  29: TCGA-AN-A0XO-01A-11D-A10G-09  1.852324e+01  1.228874e+01  1.174155e+01</span></span>
<span id="cb33-32"><a href="sbssig.html#cb33-32"></a><span class="co">#&gt;  30: TCGA-AO-A1KS-01A-11D-A13L-09  4.164234e+00  3.175461e+01  1.956542e+01</span></span>
<span id="cb33-33"><a href="sbssig.html#cb33-33"></a><span class="co">#&gt;  31: TCGA-AQ-A54O-01A-11D-A25Q-09  3.055399e-28  2.459937e+01  5.953473e-01</span></span>
<span id="cb33-34"><a href="sbssig.html#cb33-34"></a><span class="co">#&gt;  32: TCGA-AQ-A7U7-01A-22D-A351-09  1.358585e+01  1.441648e+01  7.330881e+01</span></span>
<span id="cb33-35"><a href="sbssig.html#cb33-35"></a><span class="co">#&gt;  33: TCGA-AR-A0TP-01A-11D-A099-09  5.768672e+01  6.630986e+00  5.803076e+00</span></span>
<span id="cb33-36"><a href="sbssig.html#cb33-36"></a><span class="co">#&gt;  34: TCGA-AR-A0U3-01A-11D-A10G-09  1.733324e+01  2.281135e+01 3.013800e-322</span></span>
<span id="cb33-37"><a href="sbssig.html#cb33-37"></a><span class="co">#&gt;  35: TCGA-AR-A1AH-01A-11D-A12B-09  9.496609e+01  1.443596e+01  8.395297e+00</span></span>
<span id="cb33-38"><a href="sbssig.html#cb33-38"></a><span class="co">#&gt;  36: TCGA-AR-A1AJ-01A-21D-A12Q-09  7.534377e+00  2.369358e+01  2.277121e+01</span></span>
<span id="cb33-39"><a href="sbssig.html#cb33-39"></a><span class="co">#&gt;  37: TCGA-AR-A1AN-01A-11D-A12Q-09  6.529774e+00  2.102345e+01  5.820990e+00</span></span>
<span id="cb33-40"><a href="sbssig.html#cb33-40"></a><span class="co">#&gt;  38: TCGA-AR-A24N-01A-11D-A167-09  2.004502e+01  2.261256e+01  4.435549e+00</span></span>
<span id="cb33-41"><a href="sbssig.html#cb33-41"></a><span class="co">#&gt;  39: TCGA-AR-A252-01A-11D-A167-09  6.130705e+00  1.263644e+01 3.556170e-312</span></span>
<span id="cb33-42"><a href="sbssig.html#cb33-42"></a><span class="co">#&gt;  40: TCGA-AR-A2LL-01A-11D-A17W-09  1.503319e+01  2.218907e+01 8.682292e-233</span></span>
<span id="cb33-43"><a href="sbssig.html#cb33-43"></a><span class="co">#&gt;  41: TCGA-AR-A2LO-01A-31D-A18P-09  1.413060e+01  2.481548e+00  3.266687e+00</span></span>
<span id="cb33-44"><a href="sbssig.html#cb33-44"></a><span class="co">#&gt;  42: TCGA-B6-A0IE-01A-11W-A050-09  2.018322e+01  1.947366e+01  2.614518e+00</span></span>
<span id="cb33-45"><a href="sbssig.html#cb33-45"></a><span class="co">#&gt;  43: TCGA-B6-A0IM-01A-11W-A050-09  2.162813e+01  1.865495e+01  3.521674e-57</span></span>
<span id="cb33-46"><a href="sbssig.html#cb33-46"></a><span class="co">#&gt;  44: TCGA-B6-A0IP-01A-11D-A045-09  1.442865e+01  3.592925e+01  8.112508e-01</span></span>
<span id="cb33-47"><a href="sbssig.html#cb33-47"></a><span class="co">#&gt;  45: TCGA-B6-A0RV-01A-11D-A099-09 1.560069e-177  1.750629e+01  4.905081e+01</span></span>
<span id="cb33-48"><a href="sbssig.html#cb33-48"></a><span class="co">#&gt;  46: TCGA-B6-A0WZ-01A-11D-A10G-09  6.958489e+00  6.417496e+00  8.073838e+01</span></span>
<span id="cb33-49"><a href="sbssig.html#cb33-49"></a><span class="co">#&gt;  47: TCGA-B6-A0X1-01A-11D-A10G-09  4.814384e+01  2.024595e+01  2.160594e+01</span></span>
<span id="cb33-50"><a href="sbssig.html#cb33-50"></a><span class="co">#&gt;  48: TCGA-B6-A1KC-01B-11D-A159-09  1.272953e+01  2.179920e+01  7.508081e-01</span></span>
<span id="cb33-51"><a href="sbssig.html#cb33-51"></a><span class="co">#&gt;  49: TCGA-B6-A401-01A-11D-A23C-09  1.081423e+01  1.941480e+01  2.059546e-01</span></span>
<span id="cb33-52"><a href="sbssig.html#cb33-52"></a><span class="co">#&gt;  50: TCGA-B6-A40C-01A-11D-A23C-09  1.830003e+01  3.154423e+01  2.647047e+00</span></span>
<span id="cb33-53"><a href="sbssig.html#cb33-53"></a><span class="co">#&gt;  51: TCGA-BH-A0AV-01A-31D-A10Y-09  6.587096e+01  2.929251e+00  1.572687e+01</span></span>
<span id="cb33-54"><a href="sbssig.html#cb33-54"></a><span class="co">#&gt;  52: TCGA-BH-A0BT-01A-11D-A12Q-09  6.568456e+00  3.775611e+01  2.752085e+00</span></span>
<span id="cb33-55"><a href="sbssig.html#cb33-55"></a><span class="co">#&gt;  53: TCGA-BH-A0DL-01A-11D-A10Y-09  2.910845e+01  6.775503e+01  2.920173e+01</span></span>
<span id="cb33-56"><a href="sbssig.html#cb33-56"></a><span class="co">#&gt;  54: TCGA-BH-A0DO-01B-11D-A12B-09  1.010194e+01  1.427067e+01  5.289001e+00</span></span>
<span id="cb33-57"><a href="sbssig.html#cb33-57"></a><span class="co">#&gt;  55: TCGA-BH-A0DT-01A-21D-A12B-09  3.335864e+00  1.048536e+01  2.024691e+00</span></span>
<span id="cb33-58"><a href="sbssig.html#cb33-58"></a><span class="co">#&gt;  56: TCGA-BH-A0GY-01A-11W-A071-09  1.586565e+01  2.609193e+01 7.451332e-171</span></span>
<span id="cb33-59"><a href="sbssig.html#cb33-59"></a><span class="co">#&gt;  57: TCGA-BH-A0H6-01A-21W-A071-09  1.075555e+01  1.584751e+01 6.033999e-182</span></span>
<span id="cb33-60"><a href="sbssig.html#cb33-60"></a><span class="co">#&gt;  58: TCGA-BH-A18K-01A-11D-A12B-09  2.201843e+01  1.341495e+01  3.649113e+01</span></span>
<span id="cb33-61"><a href="sbssig.html#cb33-61"></a><span class="co">#&gt;  59: TCGA-BH-A1FU-01A-11D-A14G-09  6.503440e+01  2.615015e+01  2.435476e+01</span></span>
<span id="cb33-62"><a href="sbssig.html#cb33-62"></a><span class="co">#&gt;  60: TCGA-BH-A202-01A-11D-A14K-09  9.499339e+00  1.718580e+01  8.725869e-01</span></span>
<span id="cb33-63"><a href="sbssig.html#cb33-63"></a><span class="co">#&gt;  61: TCGA-BH-A5IZ-01A-11D-A27P-09  1.272274e+02  1.895424e+01  3.599703e+01</span></span>
<span id="cb33-64"><a href="sbssig.html#cb33-64"></a><span class="co">#&gt;  62: TCGA-BH-A6R8-01A-21D-A33E-09  1.333218e+01  2.247599e+01  5.410627e+00</span></span>
<span id="cb33-65"><a href="sbssig.html#cb33-65"></a><span class="co">#&gt;  63: TCGA-BH-A8G0-01A-11D-A351-09  5.329473e-61  2.044391e+01  0.000000e+00</span></span>
<span id="cb33-66"><a href="sbssig.html#cb33-66"></a><span class="co">#&gt;  64: TCGA-C8-A131-01A-11D-A10Y-09  2.892229e+01  4.000734e+01  4.478124e+00</span></span>
<span id="cb33-67"><a href="sbssig.html#cb33-67"></a><span class="co">#&gt;  65: TCGA-D8-A147-01A-11D-A10Y-09  1.170598e+02  3.708374e+00  7.345449e+01</span></span>
<span id="cb33-68"><a href="sbssig.html#cb33-68"></a><span class="co">#&gt;  66: TCGA-D8-A1JG-01B-11D-A13L-09  8.510523e+01  6.270187e+01  2.084379e+01</span></span>
<span id="cb33-69"><a href="sbssig.html#cb33-69"></a><span class="co">#&gt;  67: TCGA-D8-A1JH-01A-11D-A188-09  1.123474e+01  1.153185e+01  9.875530e-01</span></span>
<span id="cb33-70"><a href="sbssig.html#cb33-70"></a><span class="co">#&gt;  68: TCGA-D8-A1JJ-01A-31D-A14K-09  1.266815e+01  3.477698e+01  5.170826e+01</span></span>
<span id="cb33-71"><a href="sbssig.html#cb33-71"></a><span class="co">#&gt;  69: TCGA-D8-A1JT-01A-31D-A13L-09  2.184767e+01  2.034265e+01  0.000000e+00</span></span>
<span id="cb33-72"><a href="sbssig.html#cb33-72"></a><span class="co">#&gt;  70: TCGA-D8-A1JU-01A-11D-A13L-09  9.975756e+00  9.782078e+00  6.083460e-02</span></span>
<span id="cb33-73"><a href="sbssig.html#cb33-73"></a><span class="co">#&gt;  71: TCGA-D8-A1X7-01A-11D-A14K-09  1.298671e+01  1.517123e+01  3.439192e+00</span></span>
<span id="cb33-74"><a href="sbssig.html#cb33-74"></a><span class="co">#&gt;  72: TCGA-D8-A1X8-01A-11D-A14K-09  1.460678e+01  1.557185e+01  2.380506e+00</span></span>
<span id="cb33-75"><a href="sbssig.html#cb33-75"></a><span class="co">#&gt;  73: TCGA-D8-A1XL-01A-11D-A14K-09  7.763404e+01  2.055349e+01  7.951866e+00</span></span>
<span id="cb33-76"><a href="sbssig.html#cb33-76"></a><span class="co">#&gt;  74: TCGA-D8-A27V-01A-12D-A17D-09  3.443723e-45  3.089542e+01  1.885408e+02</span></span>
<span id="cb33-77"><a href="sbssig.html#cb33-77"></a><span class="co">#&gt;  75: TCGA-E2-A108-01A-13D-A10M-09  3.697383e+01  1.205971e+01  1.342740e+02</span></span>
<span id="cb33-78"><a href="sbssig.html#cb33-78"></a><span class="co">#&gt;  76: TCGA-E2-A10F-01A-11D-A10M-09 1.114497e-181  2.407471e+01  5.142756e+00</span></span>
<span id="cb33-79"><a href="sbssig.html#cb33-79"></a><span class="co">#&gt;  77: TCGA-E2-A14T-01A-11D-A10Y-09  1.818548e+01  1.757560e+01  7.623413e+00</span></span>
<span id="cb33-80"><a href="sbssig.html#cb33-80"></a><span class="co">#&gt;  78: TCGA-E2-A152-01A-11D-A12B-09  3.004158e-05  1.904189e+01  1.453822e+02</span></span>
<span id="cb33-81"><a href="sbssig.html#cb33-81"></a><span class="co">#&gt;  79: TCGA-E2-A15D-01A-11D-A10Y-09  1.239561e+01  2.367115e+01  1.043255e-01</span></span>
<span id="cb33-82"><a href="sbssig.html#cb33-82"></a><span class="co">#&gt;  80: TCGA-E2-A15L-01A-11D-A12B-09 8.316254e-163  3.696156e+01  7.198468e+00</span></span>
<span id="cb33-83"><a href="sbssig.html#cb33-83"></a><span class="co">#&gt;  81: TCGA-E2-A1BD-01A-11D-A12Q-09  1.325256e+01  2.837122e+01  2.099082e-01</span></span>
<span id="cb33-84"><a href="sbssig.html#cb33-84"></a><span class="co">#&gt;  82: TCGA-E2-A1IH-01A-11D-A188-09  1.809753e+01  2.554536e+01  4.060186e+01</span></span>
<span id="cb33-85"><a href="sbssig.html#cb33-85"></a><span class="co">#&gt;  83: TCGA-E2-A1II-01A-11D-A142-09  3.354037e+01  8.480730e-01 3.013800e-322</span></span>
<span id="cb33-86"><a href="sbssig.html#cb33-86"></a><span class="co">#&gt;  84: TCGA-E2-A1IJ-01A-11D-A142-09  6.756677e+00  1.299390e+01 2.269978e-182</span></span>
<span id="cb33-87"><a href="sbssig.html#cb33-87"></a><span class="co">#&gt;  85: TCGA-E2-A1L6-01A-11D-A13L-09  3.756995e+00  2.424052e+01  2.129975e-01</span></span>
<span id="cb33-88"><a href="sbssig.html#cb33-88"></a><span class="co">#&gt;  86: TCGA-E2-A9RU-01A-11D-A41F-09  2.127087e+01  6.202103e+01  2.115210e+01</span></span>
<span id="cb33-89"><a href="sbssig.html#cb33-89"></a><span class="co">#&gt;  87: TCGA-E9-A1NE-01A-21D-A14K-09  5.089464e+01  3.340837e+00  6.326526e+00</span></span>
<span id="cb33-90"><a href="sbssig.html#cb33-90"></a><span class="co">#&gt;  88: TCGA-E9-A22A-01A-11D-A159-09  1.977296e+01  6.638223e+00  1.027258e+01</span></span>
<span id="cb33-91"><a href="sbssig.html#cb33-91"></a><span class="co">#&gt;  89: TCGA-E9-A22E-01A-11D-A159-09  9.379149e+01  8.398077e+00  4.506802e+01</span></span>
<span id="cb33-92"><a href="sbssig.html#cb33-92"></a><span class="co">#&gt;  90: TCGA-E9-A3QA-01A-61D-A228-09  3.295112e+01  3.947921e+00  2.814997e+01</span></span>
<span id="cb33-93"><a href="sbssig.html#cb33-93"></a><span class="co">#&gt;  91: TCGA-E9-A5FL-01A-11D-A27P-09  9.173188e+01  1.165295e+01  2.949295e+01</span></span>
<span id="cb33-94"><a href="sbssig.html#cb33-94"></a><span class="co">#&gt;  92: TCGA-EW-A1PA-01A-11D-A142-09  2.061895e+01  1.721686e+01  4.530208e+00</span></span>
<span id="cb33-95"><a href="sbssig.html#cb33-95"></a><span class="co">#&gt;  93: TCGA-EW-A1PH-01A-11D-A14K-09  2.609288e+01  3.002828e+01  8.280088e+00</span></span>
<span id="cb33-96"><a href="sbssig.html#cb33-96"></a><span class="co">#&gt;  94: TCGA-GM-A2DB-01A-31D-A19Y-09  8.511084e+01  2.993667e+01  1.374699e+01</span></span>
<span id="cb33-97"><a href="sbssig.html#cb33-97"></a><span class="co">#&gt;  95: TCGA-LD-A9QF-01A-32D-A41F-09  1.531207e+01  2.246112e+01  1.427438e+00</span></span>
<span id="cb33-98"><a href="sbssig.html#cb33-98"></a><span class="co">#&gt;  96: TCGA-LL-A5YP-01A-21D-A28B-09  7.894136e+01  6.635690e+00  2.079587e+01</span></span>
<span id="cb33-99"><a href="sbssig.html#cb33-99"></a><span class="co">#&gt;  97: TCGA-LL-A73Z-01A-11D-A32I-09  2.442986e+01  2.675728e+01  2.533581e+00</span></span>
<span id="cb33-100"><a href="sbssig.html#cb33-100"></a><span class="co">#&gt;  98: TCGA-OL-A5RY-01A-21D-A28B-09  7.440440e+00  7.048267e+00  1.414288e+00</span></span>
<span id="cb33-101"><a href="sbssig.html#cb33-101"></a><span class="co">#&gt;  99: TCGA-PE-A5DD-01A-12D-A27P-09  5.246539e+00  3.625459e+01  4.294177e+01</span></span>
<span id="cb33-102"><a href="sbssig.html#cb33-102"></a><span class="co">#&gt; 100: TCGA-S3-AA17-01A-11D-A41F-09  9.522553e+01  2.687635e+01  2.082856e+01</span></span>
<span id="cb33-103"><a href="sbssig.html#cb33-103"></a><span class="co">#&gt;                            sample          Sig1          Sig2          Sig3</span></span></code></pre></div>
<p>For plotting signature profile and exposure profile, please go to chapter <a href="sigobject.html#sigobject">8</a>.</p>
<p>For optimizing signature exposure, please use <code>sig_fit()</code>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-alexandrov2020repertoire">
<p>Alexandrov, Ludmil B, Jaegil Kim, Nicholas J Haradhvala, Mi Ni Huang, Alvin Wei Tian Ng, Yang Wu, Arnoud Boot, et al. 2020. “The Repertoire of Mutational Signatures in Human Cancer.” <em>Nature</em> 578 (7793): 94–101.</p>
</div>
<div id="ref-gaujoux2010flexible">
<p>Gaujoux, Renaud, and Cathal Seoighe. 2010. “A Flexible R Package for Nonnegative Matrix Factorization.” <em>BMC Bioinformatics</em> 11 (1): 367.</p>
</div>
<div id="ref-kim2016somatic">
<p>Kim, Jaegil, Kent W Mouw, Paz Polak, Lior Z Braunstein, Atanas Kamburov, Grace Tiao, David J Kwiatkowski, et al. 2016. “Somatic Ercc2 Mutations Are Associated with a Distinct Genomic Signature in Urothelial Tumors.” <em>Nature Genetics</em> 48 (6): 600.</p>
</div>
<div id="ref-mayakonda2018maftools">
<p>Mayakonda, Anand, De-Chen Lin, Yassen Assenov, Christoph Plass, and H Phillip Koeffler. 2018. “Maftools: Efficient and Comprehensive Analysis of Somatic Variants in Cancer.” <em>Genome Research</em> 28 (11): 1747–56.</p>
</div>
<div id="ref-tan2012automatic">
<p>Tan, Vincent YF, and Cédric Févotte. 2012. “Automatic Relevance Determination in Nonnegative Matrix Factorization with the/Spl Beta/-Divergence.” <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em> 35 (7): 1592–1605.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cnsig.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ShixiangWang/sigminer-doc/edit/master/01-COSMIC-signature-identification.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["sigminer-doc.pdf", "sigminer-doc.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
