# (PART) Target Visualization  {-}

# CopyNumber Object {#cnobject}

## Profile 

```{r}
show_cn_profile(cn, nrow = 2, ncol = 1)
```


```{r}
show_cn_circos(cn, samples = 1)
```



## Distribution 


```{r}
show_cn_distribution(cn, mode = "ld")
```


```{r}
show_cn_distribution(cn, mode = "cd")
```


# Signature Object {#sigobject}

`Signature` is a core object in **sigminer**, it stores signatures and their exposures. Here we show how to plot signature profile and exposure profile. The result plots are basically **ggplot** based, so they can be further edited by your custom operations with **ggplot** grammar.

## Signature Profile 

A signature is composed of distinct component patterns. They can be shown by `show_sig_profile()`. Of note, for different types of signature, the bar heights may have different meanings.

- SBS signatures are displayed based on the observed component frequency of the human genome, i.e., representing the relative proportions of mutations generated by each signature based on the actual trinucleotide frequencies of the reference human genome.
- Similar to SBS signatures, copy number signatures are displayed based on the observed component frequency of the human genome. Of note, considering the count process of each feature is relatively independent, the profile is row normalized by each feature, unlike Macintyre et al. (2018) did column normalization (this method is easy to mislead readers), so the bar height can be compared within/between features.

### SBS Signature profile 

```{r, fig.width=12}
show_sig_profile(mt_sig, mode = "SBS", paint_axis_text = FALSE, x_label_angle = 90)
```


```{r, fig.width=12}
show_sig_profile(mt_sig, mode = "SBS", style = "cosmic", x_label_angle = 90)
```


### Copy Number Signature Porfile  

For copy number signatures from tally method "W", you have to specify the `normalize` option as "feature", so  the bar heights can be more clearly compared.

```{r, fig.width=12}
show_sig_profile(sig_w,
                 mode = "copynumber",
                 normalize = "feature",
                 method = "W",
                 style = "cosmic")
```

### COSMIC Signature Profile  

Users can show profile of COSMIC signatures by `show_cosmic_sig_profile()`.

To see valid signature numbers, run

```{r}
show_cosmic_sig_profile(sig_db = "legacy")
```

> 'legacy' is for COSMIC v2.

```{r}
show_cosmic_sig_profile(sig_db = "SBS")
```


To show the plot, specify signature shortnames to `sig_index` option.

```{r, fig.width=12}
show_cosmic_sig_profile(sig_index = c(1, 5, 6), style = "cosmic")
```


```{r, fig.width=12}
show_cosmic_sig_profile(sig_index = c(1, 2, 3), style = "cosmic", sig_db = "DBS")
```


```{r, fig.width=12}
show_cosmic_sig_profile(sig_index = c(4, 5, 6), style = "cosmic", sig_db = "ID")
```

## Exposure Profile 


```{r, fig.width=12}
show_sig_exposure(mt_sig)
```

```{r, fig.width=12}
show_sig_exposure(mt_sig, style = "cosmic")
```


```{r, fig.width=12}
show_sig_exposure(sig_w, style = "cosmic")
```

Of note:

- For COSMIC signatures, the absolute exposure is the estimated mutation counts.
- For copy number signatures, the absolute exposure is the estimated copy number segments.


## Consensus Map  

This can only support the result from `sig_extract()` with multiple runs. 

```{r}
show_sig_consensusmap(mt_sig)
```


## Catalogue Profile

Based on plot method for signature, we can plot raw catalogue profile.

```{r, fig.width=12, fig.height=2.5}
show_catalogue(t(mt_tally$nmf_matrix), style = "cosmic", x_label_angle = 90)
```

At default, the function sums all samples. Users can specify sample ID.


```{r, fig.width=12, fig.height=2.5}
show_catalogue(t(mt_tally$nmf_matrix), style = "cosmic", samples = "TCGA-E9-A22E-01A-11D-A159-09", x_label_angle = 90)
```

